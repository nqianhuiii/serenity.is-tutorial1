{
  "version": 3,
  "sources": ["../../src/slick/aggregators.ts", "../../src/slick/remoteview.ts"],
  "sourcesContent": ["\uFEFFimport { escape, Column, GroupTotals, NonDataRow, convertCompatFormatter } from \"@serenity-is/sleekgrid\";\r\nimport { formatNumber, htmlEncode, tryGetText } from \"@serenity-is/corelib/q\";\r\n\r\nexport {}\r\n\r\nexport namespace Aggregators\r\n{\r\n    export function Avg(field: string): void {\r\n        this.field_ = field;\r\n        this.type_ = \"Avg\";\r\n\r\n        this.init = function () {\r\n            this.count_ = 0;\r\n            this.nonNullCount_ = 0;\r\n            this.sum_ = 0;\r\n        };\r\n\r\n        this.accumulate = function (item: any) {\r\n            var val = item[this.field_];\r\n            this.count_++;\r\n            if (val != null && val !== \"\" && !isNaN(val)) {\r\n                this.nonNullCount_++;\r\n                this.sum_ += parseFloat(val);\r\n            }\r\n        };\r\n\r\n        this.storeResult = function (groupTotals: any) {\r\n            if (!groupTotals.avg) {\r\n                groupTotals.avg = {};\r\n            }\r\n            if (this.nonNullCount_ != 0) {\r\n                groupTotals.avg[this.field_] = this.sum_ / this.nonNullCount_;\r\n            }\r\n        };\r\n    }\r\n\r\n    export function WeightedAvg(field: string, weightedField: string) {\r\n        this.field_ = field;\r\n        this.type_ = \"WeightedAvg\";\r\n        this.weightedField_ = weightedField;\r\n\r\n        this.init = function () {\r\n            this.sum_ = 0;\r\n            this.weightedSum_ = 0;\r\n        };\r\n\r\n        this.accumulate = function (item: any) {\r\n            var val = item[this.field_];\r\n            var valWeighted = item[this.weightedField_];\r\n            if (this.isValid(val) && this.isValid(valWeighted)) {\r\n                this.weightedSum_ += parseFloat(valWeighted);\r\n                this.sum_ += parseFloat(val) * parseFloat(valWeighted);\r\n            }\r\n        };\r\n\r\n        this.storeResult = function (groupTotals: any) {\r\n            if (!groupTotals.avg) {\r\n                groupTotals.avg = {};\r\n            }\r\n\r\n            if (this.sum_ && this.weightedSum_) {\r\n                groupTotals.avg[this.field_] = this.sum_ / this.weightedSum_;\r\n            }\r\n        };\r\n\r\n        this.isValid = function (val: any) {\r\n            return val !== null && val !== \"\" && !isNaN(val);\r\n        };\r\n    }\r\n\r\n    export function Min(field: string): void {\r\n        this.field_ = field;\r\n        this.type_ = \"Min\";\r\n\r\n        this.init = function () {\r\n            this.min_ = null;\r\n        };\r\n\r\n        this.accumulate = function (item: any) {\r\n            var val = item[this.field_];\r\n            if (val != null && val !== \"\" && !isNaN(val)) {\r\n                if (this.min_ == null || val < this.min_) {\r\n                    this.min_ = val;\r\n                }\r\n            }\r\n        };\r\n\r\n        this.storeResult = function (groupTotals: any) {\r\n            if (!groupTotals.min) {\r\n                groupTotals.min = {};\r\n            }\r\n            groupTotals.min[this.field_] = this.min_;\r\n        }\r\n    }\r\n\r\n    export function Max(field: string): void {\r\n        this.field_ = field;\r\n        this.type_ = \"Max\";\r\n\r\n        this.init = function () {\r\n            this.max_ = null;\r\n        };\r\n\r\n        this.accumulate = function (item: any) {\r\n            var val = item[this.field_];\r\n            if (val != null && val !== \"\" && !isNaN(val)) {\r\n                if (this.max_ == null || val > this.max_) {\r\n                    this.max_ = val;\r\n                }\r\n            }\r\n        };\r\n\r\n        this.storeResult = function (groupTotals: any) {\r\n            if (!groupTotals.max) {\r\n                groupTotals.max = {};\r\n            }\r\n            groupTotals.max[this.field_] = this.max_;\r\n        }\r\n    }\r\n\r\n    export function Sum(field: string): void {\r\n        this.field_ = field;\r\n        this.type_ = \"Sum\";\r\n\r\n        this.init = function () {\r\n            this.sum_ = null;\r\n        };\r\n\r\n        this.accumulate = function (item: any) {\r\n            var val = item[this.field_];\r\n            if (val != null && val !== \"\" && !isNaN(val)) {\r\n                this.sum_ += parseFloat(val);\r\n            }\r\n        };\r\n\r\n        this.storeResult = function (groupTotals: any) {\r\n            if (!groupTotals.sum) {\r\n                groupTotals.sum = {};\r\n            }\r\n            groupTotals.sum[this.field_] = this.sum_;\r\n        }\r\n    }\r\n}\r\n\r\nexport namespace AggregateFormatting {\r\n    export function formatMarkup<TItem = any>(totals: GroupTotals, column: Column<TItem>, aggType: string): string {\r\n        var textKey = (aggType.substring(0, 1).toUpperCase() + aggType.substring(1));\r\n        var text = tryGetText(\"Enums.Serenity.SummaryType.\" + textKey) ?? textKey;\r\n    \r\n        var value = totals[aggType][column.field];\r\n        var formattedValue = formatValue(column, value);\r\n    \r\n        return \"<span class='aggregate agg-\" + aggType + \"'  title='\" + htmlEncode(text) + \"'>\" +\r\n            formattedValue +\r\n            \"</span>\";\r\n    }\r\n\r\n    export function formatValue(column: Column, value: number): string {\r\n\r\n        var formatter = column.format ?? (column.formatter ? convertCompatFormatter(column.formatter) : null);\r\n\r\n        if (formatter != null) {\r\n            var item = new NonDataRow();\r\n            item[column.field] = value;\r\n            try {\r\n                return formatter({ column, escape, item, value });\r\n            }\r\n            catch (e) {\r\n            }\r\n        }\r\n\r\n        if (typeof value === \"number\") {\r\n            var displayFormat = column.sourceItem?.displayFormat ?? \"#,##0.##\";\r\n            return htmlEncode(formatNumber(value, displayFormat));\r\n        }\r\n        else\r\n            return htmlEncode(value);\r\n    }\r\n\r\n    export function groupTotalsFormatter<TItem = any>(totals: GroupTotals, column: Column<TItem>): string {\r\n        if (!totals || !column)\r\n            return \"\";\r\n    \r\n        var text: string = null;\r\n    \r\n        [\"sum\", \"avg\", \"min\", \"max\", \"cnt\"].forEach(function (aggType) {\r\n            if (text == null && totals[aggType] && totals[aggType][column.field] != null) {\r\n                text = formatMarkup(totals, column, aggType);\r\n                return false;\r\n            }\r\n        });\r\n    \r\n        return text || \"\";\r\n    }       \r\n}", "\uFEFFimport { deepClone, extend, htmlEncode, ListRequest, ListResponse, notifyError, ServiceResponse, localText } from \"@serenity-is/corelib/q\";\r\nimport { EventEmitter, EventData, Grid, gridDefaults, Group, GroupItemMetadataProvider, GroupTotals } from \"@serenity-is/sleekgrid\";\r\nimport { AggregateFormatting } from \"./aggregators\";\r\nimport { GroupInfo, PagingOptions, SummaryOptions } from \"./slicktypes\";\r\n\r\nexport interface RemoteViewOptions {\r\n    autoLoad?: boolean;\r\n    idField?: string;\r\n    contentType?: string;\r\n    dataType?: string;\r\n    filter?: any;\r\n    params?: any;\r\n    onSubmit?: CancellableViewCallback<any>;\r\n    url?: string;\r\n    localSort?: boolean;\r\n    sortBy?: any;\r\n    rowsPerPage?: number;\r\n    seekToPage?: number;\r\n    onProcessData?: RemoteViewProcessCallback<any>;\r\n    method?: string;\r\n    inlineFilters?: boolean;\r\n    groupItemMetadataProvider?: GroupItemMetadataProvider;\r\n    onAjaxCall?: RemoteViewAjaxCallback<any>;\r\n    getItemMetadata?: (p1?: any, p2?: number) => any;\r\n    errorMsg?: string;\r\n}\r\n    \r\nexport interface PagingInfo {\r\n    rowsPerPage: number;\r\n    page: number,\r\n    totalCount: number;\r\n    loading: boolean,\r\n    error: string;\r\n    dataView: RemoteView<any>\r\n}\r\n\r\nexport type CancellableViewCallback<TEntity> = (view: RemoteView<TEntity>) => boolean | void;\r\nexport type RemoteViewAjaxCallback<TEntity> = (view: RemoteView<TEntity>, options: JQueryAjaxSettings) => boolean | void;\r\nexport type RemoteViewFilter<TEntity> = (item: TEntity, view: RemoteView<TEntity>) => boolean;\r\nexport type RemoteViewProcessCallback<TEntity> = (data: ListResponse<TEntity>, view: RemoteView<TEntity>) => ListResponse<TEntity>;\r\n\r\nexport interface RemoteView<TEntity> {\r\n    onSubmit: CancellableViewCallback<TEntity>;\r\n    onDataChanged: EventEmitter;\r\n    onDataLoading: EventEmitter;\r\n    onDataLoaded: EventEmitter;\r\n    onPagingInfoChanged: EventEmitter;\r\n    onRowCountChanged: EventEmitter;\r\n    onRowsChanged: EventEmitter;\r\n    onRowsOrCountChanged: EventEmitter;\r\n    getPagingInfo(): PagingInfo;\r\n    onGroupExpanded: EventEmitter,\r\n    onGroupCollapsed: EventEmitter,\r\n    onAjaxCall: RemoteViewAjaxCallback<TEntity>;\r\n    onProcessData: RemoteViewProcessCallback<TEntity>;\r\n    addData(data: ListResponse<TEntity>): void;\r\n    beginUpdate(): void;\r\n    endUpdate(): void;\r\n    deleteItem(id: any): void;\r\n    getItems(): TEntity[];\r\n    setFilter(filter: RemoteViewFilter<TEntity>): void;\r\n    getFilter(): RemoteViewFilter<TEntity>;\r\n    getFilteredItems(): any;\r\n    getGroupItemMetadataProvider(): GroupItemMetadataProvider;\r\n    setGroupItemMetadataProvider(value: GroupItemMetadataProvider): void;\r\n    fastSort: any;\r\n    setItems(items: any[], newIdProperty?: boolean | string): void;\r\n    getIdPropertyName(): string;\r\n    getItemById(id: any): TEntity;\r\n    getGrandTotals(): any;\r\n    getGrouping(): GroupInfo<TEntity>[];\r\n    getGroups(): any[];\r\n    getRowById(id: any): number;\r\n    getRowByItem(item: any): number;\r\n    getRows(): any[];\r\n    mapItemsToRows(itemArray: any[]): any[];\r\n    mapRowsToIds(rowArray: number[]): any[];\r\n    mapIdsToRows(idAray: any[]): number[];\r\n    setFilterArgs(args: any): void;\r\n    setRefreshHints(hints: any[]): void;\r\n    insertItem(insertBefore: number, item: any): void;\r\n    sortedAddItem(item: any): void;\r\n    sortedUpdateItem(id: any, item: any): void;\r\n    syncGridSelection(grid: any, preserveHidden?: boolean, preserveHiddenOnSelectionChange?: boolean): void;\r\n    syncGridCellCssStyles(grid: any, key: string): void;\r\n    getItemMetadata(i: number): any;\r\n    updateItem(id: any, item: TEntity): void;\r\n    addItem(item: TEntity): void;\r\n    getIdxById(id: any): any;\r\n    getItemByIdx(index: number): any;\r\n    setGrouping(groupInfo: GroupInfo<TEntity>[]): void;\r\n    collapseAllGroups(level: number): void;\r\n    expandAllGroups(level: number): void;\r\n    expandGroup(keys: any[]): void;\r\n    collapseGroup(keys: any[]): void;\r\n    setSummaryOptions(options: SummaryOptions): void;\r\n    setPagingOptions(options: PagingOptions): void;\r\n    refresh(): void;\r\n    populate(): void;\r\n    populateLock(): void;\r\n    populateUnlock(): void;\r\n    getItem(row: number): any;\r\n    getLength(): number;\r\n    rowsPerPage: number;\r\n    errormsg: string;\r\n    params: any;\r\n    getLocalSort(): boolean;\r\n    setLocalSort(value: boolean): void;\r\n    sort(comparer?: (a: any, b: any) => number, ascending?: boolean): void;\r\n    reSort(): void;\r\n    sortBy: string[];\r\n    url: string;\r\n    method: string;\r\n    idField: string;\r\n    seekToPage?: number;\r\n}\r\n\r\nexport class RemoteView<TEntity> {\r\n    constructor(options: RemoteViewOptions) {\r\n        var self = this;\r\n\r\n        if (gridDefaults != null && gridDefaults.groupTotalsFormatter === void 0)\r\n            gridDefaults.groupTotalsFormatter = AggregateFormatting.groupTotalsFormatter;\r\n        \r\n        var idProperty: string;\r\n        var items: any[] = [];\r\n        var rows: any[] = [];\r\n        var idxById = {};\r\n        var rowsById: any = null;\r\n        var filter: any = null;\r\n        var updated: any = null;\r\n        var suspend = 0;\r\n\r\n        var sortAsc = true;\r\n        var fastSortField: string;\r\n        var sortComparer: any;\r\n        var refreshHints: any = {};\r\n        var prevRefreshHints: any = {};\r\n        var filterArgs: any;\r\n        var filteredItems: any = [];\r\n        var compiledFilter: any;\r\n        var compiledFilterWithCaching: any;\r\n        var filterCache: any[] = [];\r\n\r\n        var groupingInfoDefaults = {\r\n            getter: <any>null,\r\n            formatter: <any>null,\r\n            comparer: function (a: any, b: any) {\r\n                return (a.value === b.value ? 0 :\r\n                    (a.value > b.value ? 1 : -1)\r\n                );\r\n            },\r\n            predefinedValues: <any[]>[],\r\n            aggregateEmpty: false,\r\n            aggregateCollapsed: false,\r\n            aggregateChildGroups: false,\r\n            collapsed: false,\r\n            displayTotalsRow: true,\r\n            lazyTotalsCalculation: false\r\n        };\r\n        var summaryOptions: any = {};\r\n        var groupingInfos: any[] = [];\r\n        var groups: any[] = [];\r\n        var toggledGroupsByLevel: any[] = [];\r\n        var groupingDelimiter = ':|:';\r\n\r\n        var page = 1;\r\n        var totalRows = 0;\r\n\r\n        var onDataChanged: EventEmitter = new EventEmitter();\r\n        var onDataLoading: EventEmitter = new EventEmitter();\r\n        var onDataLoaded: EventEmitter = new EventEmitter();\r\n        var onGroupExpanded: EventEmitter = new EventEmitter();\r\n        var onGroupCollapsed: EventEmitter = new EventEmitter();\r\n        var onPagingInfoChanged: EventEmitter = new EventEmitter();\r\n        var onRowCountChanged: EventEmitter = new EventEmitter();\r\n        var onRowsChanged: EventEmitter = new EventEmitter();\r\n        var onRowsOrCountChanged: EventEmitter = new EventEmitter();\r\n\r\n        var loading: any = false;\r\n        var errorMessage: string = null;\r\n        var populateLocks = 0;\r\n        var populateCalls = 0;\r\n        var contentType: string;\r\n        var dataType: string;\r\n        var totalCount: number = null;\r\n        var groupItemMetadataProvider = options.groupItemMetadataProvider;\r\n        var localSort: boolean = options.localSort ?? false;\r\n\r\n        var intf: RemoteView<TEntity>;\r\n\r\n        function beginUpdate() {\r\n            suspend++;\r\n        }\r\n\r\n        function endUpdate() {\r\n            suspend--;\r\n            if (suspend <= 0)\r\n                refresh();\r\n        }\r\n\r\n        function setRefreshHints(hints: any) {\r\n            refreshHints = hints;\r\n        }\r\n\r\n        function setFilterArgs(args: any) {\r\n            filterArgs = args;\r\n        }\r\n\r\n        function updateIdxById(startingIndex?: number) {\r\n            startingIndex = startingIndex || 0;\r\n            var id: any;\r\n            for (var i = startingIndex, l = items.length; i < l; i++) {\r\n                id = items[i][idProperty];\r\n                if (id === undefined) {\r\n                    var msg = \"Each data element must implement a unique '\" +\r\n                        idProperty + \"' property. Object at index '\" + i + \"' \" +\r\n                        \"has no identity value: \";\r\n\r\n                    msg += (<any>$).toJSON(items[i]);\r\n                    throw msg;\r\n                }\r\n                idxById[id] = i;\r\n            }\r\n        }\r\n\r\n        function ensureIdUniqueness() {\r\n            var id: any;\r\n            for (var i = 0, l = items.length; i < l; i++) {\r\n                id = items[i][idProperty];\r\n                if (id === undefined || idxById[id] !== i) {\r\n                    var msg = \"Each data element must implement a unique '\" +\r\n                        idProperty + \"' property. Object at index '\" + i + \"' \";\r\n\r\n                    if (id == undefined)\r\n                        msg += \"has no identity value: \";\r\n                    else\r\n                        msg += \"has repeated identity value '\" + id + \"': \";\r\n\r\n                    msg += (<any>$).toJSON(items[i]);\r\n                    throw msg;\r\n                }\r\n            }\r\n        }\r\n\r\n        function getItems() {\r\n            return items;\r\n        }\r\n\r\n        function getIdPropertyName() {\r\n            return idProperty;\r\n        }\r\n\r\n        function setItems(data: any[], newIdProperty?: string | boolean) {\r\n            if (newIdProperty != null && typeof newIdProperty == \"string\")\r\n                idProperty = newIdProperty;\r\n\r\n            items = filteredItems = data;\r\n            if (localSort) {\r\n                items.sort(getSortComparer());\r\n            }\r\n\r\n            idxById = {};\r\n            rowsById = null;\r\n            summaryOptions.totals = {};\r\n            updateIdxById();\r\n            ensureIdUniqueness();\r\n\r\n            if (suspend) {\r\n                recalc(items);\r\n            }\r\n            else {\r\n                refresh();\r\n            }\r\n\r\n            onDataChanged.notify({ dataView: self }, null, self);\r\n        }\r\n\r\n        function setPagingOptions(args: any) {\r\n            var anyChange = false;\r\n\r\n            if (args.rowsPerPage != undefined &&\r\n                intf.rowsPerPage != args.rowsPerPage) {\r\n                intf.rowsPerPage = args.rowsPerPage;\r\n                anyChange = true;\r\n            }\r\n\r\n            if (args.page != undefined) {\r\n                var newPage: number;\r\n                if (!intf.rowsPerPage)\r\n                    newPage = 1;\r\n                else if (totalCount == null)\r\n                    newPage = args.page;\r\n                else\r\n                    newPage = Math.min(args.page, Math.ceil(totalCount / intf.rowsPerPage) + 1);\r\n\r\n                if (newPage < 1)\r\n                    newPage = 1;\r\n\r\n                if (newPage != page) {\r\n                    intf.seekToPage = newPage;\r\n                    anyChange = true;\r\n                }\r\n            }\r\n\r\n            if (anyChange)\r\n                populate();\r\n        }\r\n\r\n        function getPagingInfo(): PagingInfo {\r\n            return {\r\n                rowsPerPage: intf.rowsPerPage,\r\n                page: page,\r\n                totalCount: totalCount,\r\n                loading: loading,\r\n                error: errorMessage,\r\n                dataView: intf\r\n            };\r\n        }\r\n\r\n        function getSortComparer() {\r\n            if (sortComparer != null)\r\n                return sortComparer;\r\n\r\n            var cols: string[] = [];\r\n            var asc: boolean[] = [];\r\n            var sorts = intf.sortBy || [];\r\n            for (var s of sorts) {\r\n                if (s == null)\r\n                    continue;\r\n                if (s.length > 5 && s.toLowerCase().substr(s.length - 5).toLowerCase() == ' desc') {\r\n                    asc.push(false);\r\n                    cols.push(s.substr(0, s.length - 5));\r\n                }\r\n                else {\r\n                    asc.push(true);\r\n                    cols.push(s);\r\n                }\r\n            }\r\n            return function (a: any, b: any) {\r\n                for (var i = 0, l = cols.length; i < l; i++) {\r\n                    var field = cols[i];\r\n                    var sign = asc[i] ? 1 : -1;\r\n                    var value1 = a[field], value2 = b[field];\r\n                    var result = (value1 == value2 ? 0 : (value1 > value2 ? 1 : -1)) * sign;\r\n                    if (result != 0) {\r\n                        return result;\r\n                    }\r\n                }\r\n                return 0;\r\n            }\r\n        }\r\n\r\n        function sort(comparer?: (a: any, b: any) => number, ascending?: boolean) {\r\n            sortAsc = ascending;\r\n            fastSortField = null;\r\n            if (ascending === false) {\r\n                items.reverse();\r\n            }\r\n\r\n            sortComparer = comparer;\r\n            items.sort(getSortComparer());\r\n\r\n            if (ascending === false) {\r\n                items.reverse();\r\n            }\r\n            idxById = {};\r\n            updateIdxById();\r\n            refresh();\r\n        }\r\n\r\n        function getLocalSort(): boolean {\r\n            return localSort;\r\n        }\r\n\r\n        function setLocalSort(value: boolean) {\r\n            if (localSort != value) {\r\n                localSort = value;\r\n                sort();\r\n            }\r\n        }\r\n\r\n        /***\r\n         * Provides a workaround for the extremely slow sorting in IE.\r\n         * Does a [lexicographic] sort on a give column by temporarily overriding Object.prototype.toString\r\n         * to return the value of that field and then doing a native Array.sort().\r\n         */\r\n        function fastSort(field: any, ascending: boolean) {\r\n            sortAsc = ascending;\r\n            fastSortField = field;\r\n            sortComparer = null;\r\n            var oldToString = Object.prototype.toString;\r\n            Object.prototype.toString = (typeof field === \"function\") ? field : function () {\r\n                return this[field]\r\n            };\r\n            // an extra reversal for descending sort keeps the sort stable\r\n            // (assuming a stable native sort implementation, which isn't true in some cases)\r\n            if (ascending === false) {\r\n                items.reverse();\r\n            }\r\n            items.sort();\r\n            Object.prototype.toString = oldToString;\r\n            if (ascending === false) {\r\n                items.reverse();\r\n            }\r\n            idxById = {};\r\n            updateIdxById();\r\n            refresh();\r\n        }\r\n\r\n        function reSort() {\r\n            if (fastSortField)\r\n                fastSort(fastSortField, sortAsc);\r\n            else\r\n                sort(sortComparer, sortAsc);\r\n        }\r\n\r\n        function getFilteredItems() {\r\n            return filteredItems;\r\n        }\r\n\r\n        function getFilter() {\r\n            return filter;\r\n        }\r\n\r\n        function setFilter(filterFn: any) {\r\n            filter = filterFn;\r\n            if (options.inlineFilters) {\r\n                compiledFilter = compileFilter();\r\n                compiledFilterWithCaching = compileFilterWithCaching();\r\n            }\r\n            refresh();\r\n        }\r\n\r\n        function getGrouping() {\r\n            return groupingInfos;\r\n        }\r\n\r\n        function setSummaryOptions(summary: any) {\r\n            summary = summary || {};\r\n            summaryOptions.aggregators = summary.aggregators || [];\r\n            summaryOptions.compiledAccumulators = [];\r\n            summaryOptions.totals = {};\r\n            var idx = summaryOptions.aggregators.length;\r\n            while (idx--) {\r\n                summaryOptions.compiledAccumulators[idx] = compileAccumulatorLoop(summaryOptions.aggregators[idx]);\r\n            }\r\n            setGrouping(groupingInfos || []);\r\n        }\r\n\r\n        function getGrandTotals() {\r\n            summaryOptions.totals = summaryOptions.totals || {};\r\n\r\n            if (!summaryOptions.totals.initialized) {\r\n                summaryOptions.aggregators = summaryOptions.aggregators || [];\r\n                summaryOptions.compiledAccumulators = summaryOptions.compiledAccumulators || [];\r\n                var agg: any, idx = summaryOptions.aggregators.length;\r\n\r\n                while (idx--) {\r\n                    agg = summaryOptions.aggregators[idx];\r\n                    agg.init();\r\n                    summaryOptions.compiledAccumulators[idx].call(agg, items);\r\n                    agg.storeResult(summaryOptions.totals);\r\n                }\r\n                summaryOptions.totals.initialized = true;\r\n            }\r\n\r\n            return summaryOptions.totals;\r\n        }\r\n\r\n        function setGrouping(groupingInfo: any) {\r\n            if (!groupItemMetadataProvider) {\r\n                groupItemMetadataProvider = new GroupItemMetadataProvider();\r\n            }\r\n\r\n            groups = [];\r\n            toggledGroupsByLevel = [];\r\n            groupingInfo = groupingInfo || [];\r\n            groupingInfos = (groupingInfo instanceof Array) ? groupingInfo : [groupingInfo];\r\n\r\n            for (var i = 0; i < groupingInfos.length; i++) {\r\n                var gi = groupingInfos[i] = extend(extend<any>({}, groupingInfoDefaults), deepClone(groupingInfos[i]));\r\n                gi.aggregators = gi.aggregators || summaryOptions.aggregators || [];\r\n                gi.getterIsAFn = typeof gi.getter === \"function\";\r\n\r\n                // pre-compile accumulator loops\r\n                gi.compiledAccumulators = [];\r\n                var idx = gi.aggregators.length;\r\n                while (idx--) {\r\n                    gi.compiledAccumulators[idx] = compileAccumulatorLoop(gi.aggregators[idx]);\r\n                }\r\n\r\n                toggledGroupsByLevel[i] = {};\r\n            }\r\n\r\n            refresh();\r\n        }\r\n\r\n        function getItemByIdx(i: number) {\r\n            return items[i];\r\n        }\r\n\r\n        function getIdxById(id: any) {\r\n            return idxById[id];\r\n        }\r\n\r\n        function ensureRowsByIdCache() {\r\n            if (!rowsById) {\r\n                rowsById = {};\r\n                for (var i = 0, l = rows.length; i < l; i++) {\r\n                    rowsById[rows[i][idProperty]] = i;\r\n                }\r\n            }\r\n        }\r\n\r\n        function getRowByItem(item: any) {\r\n            ensureRowsByIdCache();\r\n            return rowsById[item[idProperty]];\r\n        }\r\n\r\n        function getRowById(id: any) {\r\n            ensureRowsByIdCache();\r\n            return rowsById[id];\r\n        }\r\n\r\n        function getItemById(id: any) {\r\n            return items[idxById[id]];\r\n        }\r\n\r\n        function mapItemsToRows(itemArray: any[]) {\r\n            var rows = [];\r\n            ensureRowsByIdCache();\r\n            for (var i = 0, l = itemArray.length; i < l; i++) {\r\n                var row = rowsById[itemArray[i][idProperty]];\r\n                if (row != null) {\r\n                    rows[rows.length] = row;\r\n                }\r\n            }\r\n            return rows;\r\n        }\r\n\r\n        function mapIdsToRows(idArray: any[]) {\r\n            var rows: any[] = [];\r\n            ensureRowsByIdCache();\r\n            for (var i = 0, l = idArray.length; i < l; i++) {\r\n                var row = rowsById[idArray[i]];\r\n                if (row != null) {\r\n                    rows[rows.length] = row;\r\n                }\r\n            }\r\n            return rows;\r\n        }\r\n\r\n        function mapRowsToIds(rowArray: any[]) {\r\n            var ids: any[] = [];\r\n            for (var i = 0, l = rowArray.length; i < l; i++) {\r\n                if (rowArray[i] < rows.length) {\r\n                    ids[ids.length] = rows[rowArray[i]][idProperty];\r\n                }\r\n            }\r\n            return ids;\r\n        }\r\n\r\n        function updateItem(id: any, item: any) {\r\n            if (idxById[id] === undefined) {\r\n                throw new Error(\"Invalid id\");\r\n            }\r\n\r\n            if (id !== item[idProperty]) {\r\n                // make sure the new id is unique:\r\n                var newId = item[idProperty];\r\n                if (newId == null) {\r\n                    throw new Error(\"Cannot update item to associate with a null id\");\r\n                }\r\n                if (idxById[newId] !== undefined) {\r\n                    throw new Error(\"Cannot update item to associate with a non-unique id\");\r\n                }\r\n                idxById[newId] = idxById[id];\r\n                delete idxById[id];\r\n\r\n                if (updated && updated[id]) {\r\n                    delete updated[id];\r\n                }\r\n\r\n                id = newId;\r\n            }\r\n            items[idxById[id]] = item;\r\n\r\n            if (!updated) {\r\n                updated = {};\r\n            }\r\n            updated[id] = true;\r\n            refresh();\r\n        }\r\n\r\n        function insertItem(insertBefore: number, item: any) {\r\n            items.splice(insertBefore, 0, item);\r\n            updateIdxById(insertBefore);\r\n            refresh();\r\n        }\r\n\r\n        function addItem(item: any) {\r\n            items.push(item);\r\n            updateIdxById(items.length - 1);\r\n            refresh();\r\n        }\r\n\r\n        function deleteItem(id: any) {\r\n            var idx = idxById[id];\r\n            if (idx === undefined) {\r\n                throw \"Invalid id\";\r\n            }\r\n            delete idxById[id];\r\n            items.splice(idx, 1);\r\n            updateIdxById(idx);\r\n            refresh();\r\n        }\r\n\r\n        function sortedAddItem(item: any) {\r\n            insertItem(sortedIndex(item), item);\r\n        }\r\n\r\n        function sortedUpdateItem(id: any, item: any) {\r\n            if (idxById[id] === undefined || id !== item[idProperty]) {\r\n                throw new Error(\"Invalid or non-matching id \" + idxById[id]);\r\n            }\r\n            var comparer = getSortComparer();\r\n            var oldItem = getItemById(id);\r\n            if (comparer(oldItem, item) !== 0) {\r\n                // item affects sorting -> must use sorted add\r\n                deleteItem(id);\r\n                sortedAddItem(item);\r\n            }\r\n            else { // update does not affect sorting -> regular update works fine\r\n                updateItem(id, item);\r\n            }\r\n        }\r\n\r\n        function sortedIndex(searchItem: any) {\r\n            var low = 0, high = items.length;\r\n            var comparer = getSortComparer();\r\n            while (low < high) {\r\n                var mid = low + high >>> 1;\r\n                if (comparer(items[mid], searchItem) === -1) {\r\n                    low = mid + 1;\r\n                }\r\n                else {\r\n                    high = mid;\r\n                }\r\n            }\r\n            return low;\r\n        }\r\n\r\n        function getRows() {\r\n            return rows;\r\n        }\r\n\r\n        function getLength() {\r\n            return rows.length;\r\n        }\r\n\r\n        function getItem(i: number) {\r\n            var item = rows[i];\r\n\r\n            // if this is a group row, make sure totals are calculated and update the title\r\n            if (item && item.__group && item.totals && !item.totals.initialized) {\r\n                var gi = groupingInfos[item.level];\r\n                if (!gi.displayTotalsRow) {\r\n                    calculateTotals(item.totals);\r\n                    item.title = gi.formatter ? gi.formatter(item) : htmlEncode(item.value);\r\n                }\r\n            }\r\n            // if this is a totals row, make sure it's calculated\r\n            else if (item && item.__groupTotals && !item.initialized) {\r\n                calculateTotals(item);\r\n            }\r\n\r\n            return item;\r\n        }\r\n\r\n        function getItemMetadata(i: number) {\r\n            var item = rows[i];\r\n            if (item === undefined) {\r\n                return null;\r\n            }\r\n\r\n            // overrides for grouping rows\r\n            if (item.__group) {\r\n                return groupItemMetadataProvider.getGroupRowMetadata(item);\r\n            }\r\n\r\n            // overrides for totals rows\r\n            if (item.__groupTotals) {\r\n                return groupItemMetadataProvider.getTotalsRowMetadata(item);\r\n            }\r\n\r\n            return (options.getItemMetadata && options.getItemMetadata(item, i)) || null;\r\n        }\r\n\r\n        function expandCollapseAllGroups(level: number, collapse: boolean) {\r\n            if (level == null) {\r\n                for (var i = 0; i < groupingInfos.length; i++) {\r\n                    toggledGroupsByLevel[i] = {};\r\n                    groupingInfos[i].collapsed = collapse;\r\n\r\n                    if (collapse === true) {\r\n                        onGroupCollapsed.notify({ level: i, groupingKey: null });\r\n                    } else {\r\n                        onGroupExpanded.notify({ level: i, groupingKey: null });\r\n                    }\r\n                }\r\n            } else {\r\n                toggledGroupsByLevel[level] = {};\r\n                groupingInfos[level].collapsed = collapse;\r\n\r\n                if (collapse === true) {\r\n                    onGroupCollapsed.notify({ level: level, groupingKey: null });\r\n                } else {\r\n                    onGroupExpanded.notify({ level: level, groupingKey: null });\r\n                }\r\n            }\r\n            refresh();\r\n        }\r\n\r\n        /**\r\n         * @param level {Number} Optional level to collapse.  If not specified, applies to all levels.\r\n         */\r\n        function collapseAllGroups(level: number) {\r\n            expandCollapseAllGroups(level, true);\r\n        }\r\n\r\n        /**\r\n         * @param level {Number} Optional level to expand.  If not specified, applies to all levels.\r\n         */\r\n        function expandAllGroups(level: number) {\r\n            expandCollapseAllGroups(level, false);\r\n        }\r\n\r\n        function resolveLevelAndGroupingKey(args: any) {\r\n            var arg0 = args[0];\r\n            if (args.length === 1 && arg0.indexOf(groupingDelimiter) !== -1) {\r\n                return { level: arg0.split(groupingDelimiter).length - 1, groupingKey: arg0 };\r\n            } else {\r\n                return { level: args.length - 1, groupingKey: args.join(groupingDelimiter) };\r\n            }\r\n        }\r\n\r\n        function expandCollapseGroup(args: any, collapse: any) {\r\n            var opts = resolveLevelAndGroupingKey(args);\r\n            toggledGroupsByLevel[opts.level][opts.groupingKey] = groupingInfos[opts.level].collapsed ^ collapse;\r\n            if (collapse)\r\n                onGroupCollapsed.notify({ level: opts.level, groupingKey: opts.groupingKey });\r\n            else\r\n                onGroupExpanded.notify({ level: opts.level, groupingKey: opts.groupingKey });\r\n\r\n            refresh();\r\n        }\r\n\r\n        /**\r\n         * @param varArgs Either a Slick.Group's \"groupingKey\" property, or a\r\n         *     variable argument list of grouping values denoting a unique path to the row.  For\r\n         *     example, calling collapseGroup('high', '10%') will collapse the '10%' subgroup of\r\n         *     the 'high' group.\r\n         */\r\n        function collapseGroup(varArgs: any[]) {\r\n            var args = Array.prototype.slice.call(arguments);\r\n            expandCollapseGroup(args, true);\r\n        }\r\n\r\n        /**\r\n         * @param varArgs Either a Slick.Group's \"groupingKey\" property, or a\r\n         *     variable argument list of grouping values denoting a unique path to the row.  For\r\n         *     example, calling expandGroup('high', '10%') will expand the '10%' subgroup of\r\n         *     the 'high' group.\r\n         */\r\n        function expandGroup(varArgs: any[]) {\r\n            var args = Array.prototype.slice.call(arguments);\r\n            expandCollapseGroup(args, false);\r\n        }\r\n\r\n        function getGroups() {\r\n            return groups;\r\n        }\r\n\r\n        function getOrCreateGroup(groupsByVal: any, val: any, level: number, parentGroup: any, groups: any[]) {\r\n            var group = groupsByVal[val];\r\n\r\n            if (!group) {\r\n                group = new Group<any>();\r\n                group.value = val;\r\n                group.level = level;\r\n                group.groupingKey = (parentGroup ? parentGroup.groupingKey + groupingDelimiter : '') + val;\r\n                groups[groups.length] = group;\r\n                groupsByVal[val] = group;\r\n            }\r\n\r\n            return group;\r\n        }\r\n\r\n        function extractGroups(rows: any[], parentGroup?: any) {\r\n            var group: any;\r\n            var val: any;\r\n            var groups: any[] = [];\r\n            var groupsByVal = {};\r\n            var r: any;\r\n            var level = parentGroup ? parentGroup.level + 1 : 0;\r\n            var gi = groupingInfos[level];\r\n\r\n            for (var i = 0, l: number = gi.predefinedValues.length; i < l; i++) {\r\n                val = gi.predefinedValues[i];\r\n                group = getOrCreateGroup(groupsByVal, val, level, parentGroup, groups);\r\n            }\r\n\r\n            for (var i = 0, l = rows.length; i < l; i++) {\r\n                r = rows[i];\r\n                val = gi.getterIsAFn ? gi.getter(r) : r[gi.getter];\r\n                group = getOrCreateGroup(groupsByVal, val, level, parentGroup, groups);\r\n\r\n                group.rows[group.count++] = r;\r\n            }\r\n\r\n            if (level < groupingInfos.length - 1) {\r\n                for (var i = 0; i < groups.length; i++) {\r\n                    group = groups[i];\r\n                    group.groups = extractGroups(group.rows, group);\r\n                }\r\n            }\r\n\r\n            if (groups.length) {\r\n                addTotals(groups, level);\r\n            }\r\n\r\n            groups.sort(groupingInfos[level].comparer);\r\n\r\n            return groups;\r\n        }\r\n\r\n        function calculateTotals(totals: any) {\r\n            var group = totals.group;\r\n            var gi = groupingInfos[group.level];\r\n            var isLeafLevel = (group.level == groupingInfos.length);\r\n            var agg: any, idx = gi.aggregators.length;\r\n\r\n            if (!isLeafLevel && gi.aggregateChildGroups) {\r\n                // make sure all the subgroups are calculated\r\n                var i = group.groups.length;\r\n                while (i--) {\r\n                    if (!group.groups[i].totals.initialized) {\r\n                        calculateTotals(group.groups[i].totals);\r\n                    }\r\n                }\r\n            }\r\n\r\n            while (idx--) {\r\n                agg = gi.aggregators[idx];\r\n                agg.init();\r\n                if (!isLeafLevel && gi.aggregateChildGroups) {\r\n                    gi.compiledAccumulators[idx].call(agg, group.groups);\r\n                } else {\r\n                    gi.compiledAccumulators[idx].call(agg, group.rows);\r\n                }\r\n                agg.storeResult(totals);\r\n            }\r\n            totals.initialized = true;\r\n        }\r\n\r\n        function addGroupTotals(group: any) {\r\n            var gi = groupingInfos[group.level];\r\n            var totals = new GroupTotals<TEntity>();\r\n            totals.group = group;\r\n            group.totals = totals;\r\n            if (!gi.lazyTotalsCalculation) {\r\n                calculateTotals(totals);\r\n            }\r\n        }\r\n\r\n        function addTotals(groups: any[], level?: number) {\r\n            level = level || 0;\r\n            var gi = groupingInfos[level];\r\n            var groupCollapsed = gi.collapsed;\r\n            var toggledGroups = toggledGroupsByLevel[level];\r\n            var idx = groups.length, g: any;\r\n            while (idx--) {\r\n                g = groups[idx];\r\n\r\n                if (g.collapsed && !gi.aggregateCollapsed) {\r\n                    continue;\r\n                }\r\n\r\n                // Do a depth-first aggregation so that parent group aggregators can access subgroup totals.\r\n                if (g.groups) {\r\n                    addTotals(g.groups, level + 1);\r\n                }\r\n\r\n                if (gi.aggregators.length && (\r\n                    gi.aggregateEmpty || g.rows.length || (g.groups && g.groups.length))) {\r\n                    addGroupTotals(g);\r\n                }\r\n\r\n                g.collapsed = groupCollapsed ^ toggledGroups[g.groupingKey];\r\n                g.title = gi.formatter ? gi.formatter(g) : htmlEncode(g.value);\r\n            }\r\n        }\r\n\r\n        function flattenGroupedRows(groups: any[], level?: number) {\r\n            level = level || 0;\r\n            var gi = groupingInfos[level];\r\n            var groupedRows: any[] = [], rows: any[], gl = 0, g: any;\r\n            for (var i = 0, l = groups.length; i < l; i++) {\r\n                g = groups[i];\r\n                groupedRows[gl++] = g;\r\n\r\n                if (!g.collapsed) {\r\n                    rows = g.groups ? flattenGroupedRows(g.groups, level + 1) : g.rows;\r\n                    for (var j = 0, jj = rows.length; j < jj; j++) {\r\n                        groupedRows[gl++] = rows[j];\r\n                    }\r\n                }\r\n\r\n                if (g.totals && gi.displayTotalsRow && (!g.collapsed || gi.aggregateCollapsed)) {\r\n                    groupedRows[gl++] = g.totals;\r\n                }\r\n            }\r\n            return groupedRows;\r\n        }\r\n\r\n        function getFunctionInfo(fn: any) {\r\n            var fnRegex = /^function[^(]*\\(([^)]*)\\)\\s*{([\\s\\S]*)}$/;\r\n            var matches = fn.toString().match(fnRegex);\r\n            return {\r\n                params: matches[1].split(\",\"),\r\n                body: matches[2]\r\n            };\r\n        }\r\n\r\n        function compileAccumulatorLoop(aggregator: any) {\r\n            var accumulatorInfo = getFunctionInfo(aggregator.accumulate);\r\n            var fn: any = new Function(\r\n                \"_items\",\r\n                \"for (var \" + accumulatorInfo.params[0] + \", _i=0, _il=_items.length; _i<_il; _i++) {\" +\r\n                accumulatorInfo.params[0] + \" = _items[_i]; \" +\r\n                accumulatorInfo.body +\r\n                \"}\"\r\n            );\r\n            return fn;\r\n        }\r\n\r\n        function compileFilter() {\r\n            var filterInfo = getFunctionInfo(filter);\r\n\r\n            var filterBody = filterInfo.body\r\n                .replace(/return false\\s*([;}]|$)/gi, \"{ continue _coreloop; }$1\")\r\n                .replace(/return true\\s*([;}]|$)/gi, \"{ _retval[_idx++] = $item$; continue _coreloop; }$1\")\r\n                .replace(/return ([^;}]+?)\\s*([;}]|$)/gi,\r\n                \"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2\");\r\n\r\n            // This preserves the function template code after JS compression,\r\n            // so that replace() commands still work as expected.\r\n            var tpl = [\r\n                //\"function(_items, _args) { \",\r\n                \"var _retval = [], _idx = 0; \",\r\n                \"var $item$, $args$ = _args; \",\r\n                \"_coreloop: \",\r\n                \"for (var _i = 0, _il = _items.length; _i < _il; _i++) { \",\r\n                \"$item$ = _items[_i]; \",\r\n                \"$filter$; \",\r\n                \"} \",\r\n                \"return _retval; \"\r\n                //\"}\"\r\n            ].join(\"\");\r\n            tpl = tpl.replace(/\\$filter\\$/gi, filterBody);\r\n            tpl = tpl.replace(/\\$item\\$/gi, filterInfo.params[0]);\r\n            tpl = tpl.replace(/\\$args\\$/gi, filterInfo.params[1]);\r\n\r\n            var fn: any = new Function(\"_items,_args\", tpl);\r\n            fn.displayName = fn.name = \"compiledFilter\";\r\n            return fn;\r\n        }\r\n\r\n        function compileFilterWithCaching() {\r\n            var filterInfo = getFunctionInfo(filter);\r\n\r\n            var filterBody = filterInfo.body\r\n                .replace(/return false\\s*([;}]|$)/gi, \"{ continue _coreloop; }$1\")\r\n                .replace(/return true\\s*([;}]|$)/gi, \"{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1\")\r\n                .replace(/return ([^;}]+?)\\s*([;}]|$)/gi,\r\n                \"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2\");\r\n\r\n            // This preserves the function template code after JS compression,\r\n            // so that replace() commands still work as expected.\r\n            var tpl = [\r\n                //\"function(_items, _args, _cache) { \",\r\n                \"var _retval = [], _idx = 0; \",\r\n                \"var $item$, $args$ = _args; \",\r\n                \"_coreloop: \",\r\n                \"for (var _i = 0, _il = _items.length; _i < _il; _i++) { \",\r\n                \"$item$ = _items[_i]; \",\r\n                \"if (_cache[_i]) { \",\r\n                \"_retval[_idx++] = $item$; \",\r\n                \"continue _coreloop; \",\r\n                \"} \",\r\n                \"$filter$; \",\r\n                \"} \",\r\n                \"return _retval; \"\r\n                //\"}\"\r\n            ].join(\"\");\r\n            tpl = tpl.replace(/\\$filter\\$/gi, filterBody);\r\n            tpl = tpl.replace(/\\$item\\$/gi, filterInfo.params[0]);\r\n            tpl = tpl.replace(/\\$args\\$/gi, filterInfo.params[1]);\r\n\r\n            var fn: any = new Function(\"_items,_args,_cache\", tpl);\r\n            var fnName = \"compiledFilterWithCaching\";\r\n            fn.displayName = fnName;\r\n            fn.name = setFunctionName(fn, fnName);\r\n            return fn;\r\n        }\r\n\r\n        /**\r\n         * In ES5 we could set the function name on the fly but in ES6 this is forbidden and we need to set it through differently\r\n         * We can use Object.defineProperty and set it the property to writable, see MDN for reference\r\n         * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty\r\n         * @param {string} fn\r\n         * @param {string} fnName\r\n         */\r\n        function setFunctionName(fn: Function, fnName: string) {\r\n            try {\r\n                Object.defineProperty(fn, 'name', {\r\n                    writable: true,\r\n                    value: fnName\r\n                });\r\n            } catch (err) {\r\n                (fn as any).name = fnName;\r\n            }\r\n        }\r\n\r\n        function uncompiledFilter(items: any[], args: any) {\r\n            var retval: any[] = [], idx = 0;\r\n\r\n            for (var i = 0, ii = items.length; i < ii; i++) {\r\n                if (filter(items[i], args)) {\r\n                    retval[idx++] = items[i];\r\n                }\r\n            }\r\n\r\n            return retval;\r\n        }\r\n\r\n        function uncompiledFilterWithCaching(items: any[], args: any, cache: any) {\r\n            var retval: any[] = [], idx = 0, item: any;\r\n\r\n            for (var i = 0, ii = items.length; i < ii; i++) {\r\n                item = items[i];\r\n                if (cache[i]) {\r\n                    retval[idx++] = item;\r\n                } else if (filter(item, args)) {\r\n                    retval[idx++] = item;\r\n                    cache[i] = true;\r\n                }\r\n            }\r\n\r\n            return retval;\r\n        }\r\n\r\n        function getFilteredAndPagedItems(items: any[]) {\r\n            if (filter) {\r\n                var batchFilter = options.inlineFilters ? compiledFilter : uncompiledFilter;\r\n                var batchFilterWithCaching = options.inlineFilters ? compiledFilterWithCaching : uncompiledFilterWithCaching;\r\n\r\n                if (refreshHints.isFilterNarrowing) {\r\n                    filteredItems = batchFilter(filteredItems, filterArgs);\r\n                } else if (refreshHints.isFilterExpanding) {\r\n                    filteredItems = batchFilterWithCaching(items, filterArgs, filterCache);\r\n                } else if (!refreshHints.isFilterUnchanged) {\r\n                    filteredItems = batchFilter(items, filterArgs);\r\n                }\r\n            } else {\r\n                // special case:  if not filtering and not paging, the resulting\r\n                // rows collection needs to be a copy so that changes due to sort\r\n                // can be caught\r\n                filteredItems = items.concat();\r\n            }\r\n\r\n            // get the current page\r\n            return { totalRows: filteredItems.length, rows: filteredItems };\r\n        }\r\n\r\n        function getRowDiffs(rows: any[], newRows: any[]) {\r\n            var item: any, r: any, eitherIsNonData: boolean, diff: any[] = [];\r\n            var from = 0, to = newRows.length;\r\n\r\n            if (refreshHints && refreshHints.ignoreDiffsBefore) {\r\n                from = Math.max(0,\r\n                    Math.min(newRows.length, refreshHints.ignoreDiffsBefore));\r\n            }\r\n\r\n            if (refreshHints && refreshHints.ignoreDiffsAfter) {\r\n                to = Math.min(newRows.length,\r\n                    Math.max(0, refreshHints.ignoreDiffsAfter));\r\n            }\r\n\r\n            for (var i = from, rl = rows.length; i < to; i++) {\r\n                if (i >= rl) {\r\n                    diff[diff.length] = i;\r\n                } else {\r\n                    item = newRows[i];\r\n                    r = rows[i];\r\n\r\n                    if ((groupingInfos.length && (eitherIsNonData = (item.__nonDataRow) || (r.__nonDataRow)) &&\r\n                        item.__group !== r.__group ||\r\n                        item.__group && !item.equals(r))\r\n                        || (eitherIsNonData &&\r\n                            // no good way to compare totals since they are arbitrary DTOs\r\n                            // deep object comparison is pretty expensive\r\n                            // always considering them 'dirty' seems easier for the time being\r\n                            (item.__groupTotals || r.__groupTotals))\r\n                        || item[idProperty] != r[idProperty]\r\n                        || (updated && updated[item[idProperty]])\r\n                    ) {\r\n                        diff[diff.length] = i;\r\n                    }\r\n                }\r\n            }\r\n            return diff;\r\n        }\r\n\r\n        function recalc(_items: any[]) {\r\n            rowsById = null;\r\n\r\n            if (refreshHints.isFilterNarrowing != prevRefreshHints.isFilterNarrowing ||\r\n                refreshHints.isFilterExpanding != prevRefreshHints.isFilterExpanding) {\r\n                filterCache = [];\r\n            }\r\n\r\n            var filteredItems = getFilteredAndPagedItems(_items);\r\n            totalRows = filteredItems.totalRows;\r\n            var newRows = filteredItems.rows;\r\n\r\n            summaryOptions.totals = {};\r\n\r\n            groups = [];\r\n            if (groupingInfos.length) {\r\n                groups = extractGroups(newRows);\r\n                if (groups.length) {\r\n                    newRows = flattenGroupedRows(groups);\r\n                }\r\n            }\r\n\r\n            var diff = getRowDiffs(rows, newRows);\r\n\r\n            rows = newRows;\r\n\r\n            return diff;\r\n        }\r\n\r\n        function refresh() {\r\n            if (suspend) {\r\n                return;\r\n            }\r\n\r\n            var countBefore = rows.length;\r\n            var totalRowsBefore = totalRows;\r\n\r\n            var diff = recalc(items); // pass as direct refs to avoid closure perf hit\r\n\r\n            updated = null;\r\n            prevRefreshHints = refreshHints;\r\n            refreshHints = {};\r\n\r\n            if (totalRowsBefore !== totalRows) {\r\n                onPagingInfoChanged.notify(getPagingInfo(), null, self);\r\n            }\r\n            if (countBefore !== rows.length) {\r\n                onRowCountChanged.notify({ previous: countBefore, current: rows.length, dataView: self }, null, self);\r\n            }\r\n            if (diff.length > 0) {\r\n                onRowsChanged.notify({ rows: diff, dataView: self }, null, self);\r\n            }\r\n            if (countBefore !== rows.length || diff.length > 0) {\r\n                onRowsOrCountChanged.notify({\r\n                    rowsDiff: diff, previousRowCount: countBefore, currentRowCount: rows.length,\r\n                    rowCountChanged: countBefore !== rows.length, rowsChanged: diff.length > 0, dataView: self\r\n                }, null, self);\r\n            }\r\n        }\r\n\r\n        /***\r\n         * Wires the grid and the DataView together to keep row selection tied to item ids.\r\n         * This is useful since, without it, the grid only knows about rows, so if the items\r\n         * move around, the same rows stay selected instead of the selection moving along\r\n         * with the items.\r\n         *\r\n         * NOTE:  This doesn't work with cell selection model.\r\n         *\r\n         * @param grid {Slick.Grid} The grid to sync selection with.\r\n         * @param preserveHidden {Boolean} Whether to keep selected items that go out of the\r\n         *     view due to them getting filtered out.\r\n         * @param preserveHiddenOnSelectionChange {Boolean} Whether to keep selected items\r\n         *     that are currently out of the view (see preserveHidden) as selected when selection\r\n         *     changes.\r\n         * @return {EventEmitter} An event that notifies when an internal list of selected row ids\r\n         *     changes.  This is useful since, in combination with the above two options, it allows\r\n         *     access to the full list selected row ids, and not just the ones visible to the grid.\r\n         * @method syncGridSelection\r\n         */\r\n        function syncGridSelection(grid: any, preserveHidden: boolean, preserveHiddenOnSelectionChange: boolean) {\r\n            var self = this;\r\n            var inHandler: any;\r\n            var selectedRowIds = self.mapRowsToIds(grid.getSelectedRows());\r\n            var onSelectedRowIdsChanged = new EventEmitter();\r\n\r\n            function setSelectedRowIds(rowIds: any[]) {\r\n                if (selectedRowIds.join(\",\") == rowIds.join(\",\")) {\r\n                    return;\r\n                }\r\n\r\n                selectedRowIds = rowIds;\r\n\r\n                onSelectedRowIdsChanged.notify({\r\n                    \"grid\": grid,\r\n                    \"ids\": selectedRowIds,\r\n                    \"dataView\": self\r\n                }, new EventData(), self);\r\n            }\r\n\r\n            function update() {\r\n                if (selectedRowIds.length > 0) {\r\n                    inHandler = true;\r\n                    var selectedRows = self.mapIdsToRows(selectedRowIds);\r\n                    if (!preserveHidden) {\r\n                        setSelectedRowIds(self.mapRowsToIds(selectedRows));\r\n                    }\r\n                    grid.setSelectedRows(selectedRows);\r\n                    inHandler = false;\r\n                }\r\n            }\r\n\r\n            grid.onSelectedRowsChanged.subscribe(function (e: any, args: any) {\r\n                if (inHandler) { return; }\r\n                var newSelectedRowIds = self.mapRowsToIds(grid.getSelectedRows());\r\n                if (!preserveHiddenOnSelectionChange || !grid.getOptions().multiSelect) {\r\n                    setSelectedRowIds(newSelectedRowIds);\r\n                } else {\r\n                    // keep the ones that are hidden\r\n                    var existing = $.grep(selectedRowIds, function (id) { return self.getRowById(id) === undefined; });\r\n                    // add the newly selected ones\r\n                    setSelectedRowIds(existing.concat(newSelectedRowIds));\r\n                }\r\n            });\r\n\r\n            this.onRowsChanged.subscribe(update);\r\n            this.onRowCountChanged.subscribe(update);\r\n\r\n            return onSelectedRowIdsChanged;\r\n        }\r\n\r\n        function syncGridCellCssStyles(grid: Grid, key: string) {\r\n            var hashById: any;\r\n            var inHandler: any;\r\n\r\n            // since this method can be called after the cell styles have been set,\r\n            // get the existing ones right away\r\n            storeCellCssStyles(grid.getCellCssStyles(key));\r\n\r\n            function storeCellCssStyles(hash: any) {\r\n                hashById = {};\r\n                for (var row in hash) {\r\n                    var id: any = rows[row][idProperty];\r\n                    hashById[id] = hash[row];\r\n                }   \r\n            }\r\n\r\n            function update() {\r\n                if (hashById) {\r\n                    inHandler = true;\r\n                    ensureRowsByIdCache();\r\n                    var newHash = {};\r\n                    for (var id in hashById) {\r\n                        var row = rowsById[id];\r\n                        if (row != undefined) {\r\n                            newHash[row] = hashById[id];\r\n                        }\r\n                    }\r\n                    grid.setCellCssStyles(key, newHash);\r\n                    inHandler = false;\r\n                }\r\n            }\r\n\r\n            var subFunc = function (e: any, args: any) {\r\n                if (inHandler) { return; }\r\n                if (key != args.key) { return; }\r\n                if (args.hash) {\r\n                    storeCellCssStyles(args.hash);\r\n                }\r\n                else {\r\n                    grid.onCellCssStylesChanged.unsubscribe(subFunc);\r\n                    onRowsOrCountChanged.unsubscribe(update);\r\n                }\r\n            };\r\n\r\n            grid.onCellCssStylesChanged.subscribe(subFunc);\r\n            onRowsOrCountChanged.subscribe(update);\r\n        }\r\n\r\n        function addData(data: any) {\r\n\r\n            if (intf.onProcessData && data)\r\n                data = intf.onProcessData(data, intf) || data;\r\n\r\n            errorMessage = null;\r\n            loading && loading.abort();\r\n            loading = false;\r\n\r\n            if (!data) {\r\n                errorMessage = intf.errormsg;\r\n                onPagingInfoChanged.notify(getPagingInfo());\r\n                return false;\r\n            }\r\n\r\n            data.TotalCount = data.TotalCount || 0;\r\n            data.Entities = data.Entities || [];\r\n\r\n            if (!data.Skip || (!intf.rowsPerPage && !data.Take))\r\n                data.Page = 1;\r\n            else\r\n                data.Page = Math.ceil(data.Skip / (data.Take || intf.rowsPerPage)) + 1;\r\n\r\n            page = data.Page;\r\n            totalCount = data.TotalCount;\r\n\r\n            setItems(data.Entities);\r\n\r\n            onPagingInfoChanged.notify(getPagingInfo());\r\n        }\r\n\r\n        function populate() {\r\n            if (populateLocks > 0) {\r\n                populateCalls++;\r\n                return;\r\n            }\r\n\r\n            populateCalls = 0;\r\n\r\n            loading && loading.abort();\r\n\r\n            if (intf.onSubmit) {\r\n                var gh = intf.onSubmit(intf);\r\n                if (gh === false)\r\n                    return false;\r\n            }\r\n\r\n            onDataLoading.notify(this);\r\n\r\n            if (!intf.url)\r\n                return false;\r\n\r\n            // set loading event\r\n        \r\n            if (!intf.seekToPage)\r\n                intf.seekToPage = 1;\r\n\r\n            var request: ListRequest = {};\r\n\r\n            var skip = (intf.seekToPage - 1) * intf.rowsPerPage;\r\n            if (skip)\r\n                request.Skip = skip;\r\n            if (intf.rowsPerPage)\r\n                request.Take = intf.rowsPerPage;\r\n\r\n            if (intf.sortBy && intf.sortBy.length) {\r\n                if (typeof intf.sortBy !== \"string\")\r\n                    request.Sort = intf.sortBy;\r\n                else {\r\n                    request.Sort = [intf.sortBy];\r\n                }\r\n            }\r\n\r\n            if (intf.params) {\r\n                request = extend(request, intf.params);\r\n            }\r\n\r\n            var dt = dataType;\r\n\r\n            var ajaxOptions = {\r\n                cache: false,\r\n                type: intf.method,\r\n                contentType: contentType,\r\n                url: intf.url,\r\n                data: request,\r\n                dataType: dt,\r\n                success: function (response: ServiceResponse) {\r\n                    loading = false;\r\n                    if (response.Error)\r\n                        notifyError(response.Error.Message || response.Error.Code);\r\n                    else\r\n                        addData(response);\r\n                    onDataLoaded.notify(this);\r\n                },\r\n                error: function (xhr: any, status: any, ev: any) {\r\n                    loading = false;\r\n\r\n                    if ((xhr.getResponseHeader(\"content-type\") || '').toLowerCase().indexOf(\"application/json\") >= 0) {\r\n                        var json = $.parseJSON(xhr.responseText);\r\n                        if (json != null && json.Error != null) {\r\n                            notifyError(json.Error.Message || json.Error.Code);\r\n                            onPagingInfoChanged.notify(getPagingInfo());\r\n                            onDataLoaded.notify(this);\r\n                            return;\r\n                        }\r\n                    }\r\n\r\n                    errorMessage = xhr.errormsg;\r\n                    onPagingInfoChanged.notify(getPagingInfo());\r\n                    onDataLoaded.notify(this);\r\n                },\r\n                complete: function () {\r\n                    loading = false;\r\n                }\r\n            }\r\n\r\n            if (intf.onAjaxCall) {\r\n                var ah = intf.onAjaxCall(this, ajaxOptions);\r\n                if (ah === false) {\r\n                    loading = false;\r\n                    onPagingInfoChanged.notify(getPagingInfo());\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            ajaxOptions.data = (<any>$).toJSON(ajaxOptions.data);\r\n\r\n            onPagingInfoChanged.notify(getPagingInfo());\r\n            loading = $.ajax(ajaxOptions);\r\n        }\r\n\r\n        function populateLock() {\r\n            if (populateLocks == 0)\r\n                populateCalls = 0;\r\n            populateLocks++;\r\n        }\r\n\r\n        function populateUnlock() {\r\n            if (populateLocks > 0) {\r\n                populateLocks--;\r\n                if (populateLocks == 0 && populateCalls > 0)\r\n                    populate();\r\n            }\r\n        }\r\n\r\n        function getGroupItemMetadataProvider() {\r\n            return groupItemMetadataProvider;\r\n        }\r\n\r\n        function setGroupItemMetadataProvider(value: GroupItemMetadataProvider) {\r\n            groupItemMetadataProvider = value;\r\n        }\r\n\r\n        idProperty = options.idField || 'id';\r\n        contentType = options.contentType || \"application/json\";\r\n        dataType = options.dataType || 'json';\r\n        filter = options.filter || null;\r\n\r\n        intf = {\r\n            // methods\r\n            beginUpdate: beginUpdate,\r\n            endUpdate: endUpdate,\r\n            setPagingOptions: setPagingOptions,\r\n            getPagingInfo: getPagingInfo,\r\n            getIdPropertyName: getIdPropertyName,\r\n            getRows: getRows,\r\n            getItems: getItems,\r\n            setItems: setItems,\r\n            getFilter: getFilter,\r\n            getFilteredItems: getFilteredItems,\r\n            setFilter: setFilter,\r\n            sort: sort,\r\n            fastSort: fastSort,\r\n            reSort: reSort,\r\n            getLocalSort: getLocalSort,\r\n            setLocalSort: setLocalSort,\r\n            setSummaryOptions: setSummaryOptions,\r\n            getGrandTotals: getGrandTotals,\r\n            setGrouping: setGrouping,\r\n            getGrouping: getGrouping,\r\n            collapseAllGroups: collapseAllGroups,\r\n            expandAllGroups: expandAllGroups,\r\n            collapseGroup: collapseGroup,\r\n            expandGroup: expandGroup,\r\n            getGroups: getGroups,\r\n            getIdxById: getIdxById,\r\n            getRowByItem: getRowByItem,\r\n            getRowById: getRowById,\r\n            getItemById: getItemById,\r\n            getItemByIdx: getItemByIdx,\r\n            mapItemsToRows: mapItemsToRows,\r\n            mapRowsToIds: mapRowsToIds,\r\n            mapIdsToRows: mapIdsToRows,\r\n            setRefreshHints: setRefreshHints,\r\n            setFilterArgs: setFilterArgs,\r\n            refresh: refresh,\r\n            updateItem: updateItem,\r\n            insertItem: insertItem,\r\n            addItem: addItem,\r\n            deleteItem: deleteItem,\r\n            sortedAddItem: sortedAddItem,\r\n            sortedUpdateItem: sortedUpdateItem,\r\n            syncGridSelection: syncGridSelection,\r\n            syncGridCellCssStyles: syncGridCellCssStyles,\r\n\r\n            getLength: getLength,\r\n            getItem: getItem,\r\n            getItemMetadata: getItemMetadata,\r\n            getGroupItemMetadataProvider: getGroupItemMetadataProvider,\r\n            setGroupItemMetadataProvider: setGroupItemMetadataProvider,\r\n\r\n            onRowCountChanged: onRowCountChanged,\r\n            onRowsChanged: onRowsChanged,\r\n            onRowsOrCountChanged: onRowsOrCountChanged,\r\n            onPagingInfoChanged: onPagingInfoChanged,\r\n            onGroupExpanded: onGroupExpanded,\r\n            onGroupCollapsed: onGroupCollapsed,\r\n\r\n            addData: addData,\r\n            populate: populate,\r\n            populateLock: populateLock,\r\n            populateUnlock: populateUnlock,\r\n            onDataChanged: onDataChanged,\r\n            onDataLoaded: onDataLoaded,\r\n            onDataLoading: onDataLoading,\r\n            params: options.params || {},\r\n            onSubmit: options.onSubmit || null,\r\n            url: options.url || null,\r\n            rowsPerPage: options.rowsPerPage || 0,\r\n            seekToPage: options.seekToPage || 1,\r\n            onAjaxCall: options.onAjaxCall || null,\r\n            onProcessData: options.onProcessData || null,\r\n            method: options.method || \"POST\",\r\n            errormsg: localText(\"Controls.Pager.DefaultLoadError\"),\r\n            sortBy: typeof options.sortBy == \"string\" ? [options.sortBy] : (options.sortBy || []),\r\n            idField: idProperty\r\n        };\r\n\r\n        if (options.url && options.autoLoad) {\r\n            populate();\r\n        }\r\n\r\n        return intf;\r\n    }\r\n}\r\n"],
  "mappings": "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",
  "names": ["escape", "NonDataRow", "convertCompatFormatter", "formatNumber", "htmlEncode", "tryGetText", "Aggregators", "Avg", "field", "item", "val", "groupTotals", "WeightedAvg", "weightedField", "valWeighted", "Min", "Max", "Sum", "AggregateFormatting", "formatMarkup", "totals", "column", "aggType", "_a", "textKey", "text", "tryGetText", "value", "formattedValue", "formatValue", "htmlEncode", "_b", "_c", "formatter", "convertCompatFormatter", "NonDataRow", "escape", "e", "displayFormat", "formatNumber", "groupTotalsFormatter", "deepClone", "extend", "htmlEncode", "notifyError", "localText", "EventEmitter", "EventData", "gridDefaults", "Group", "GroupItemMetadataProvider", "GroupTotals", "RemoteView", "options", "_a", "self", "gridDefaults", "AggregateFormatting", "idProperty", "items", "rows", "idxById", "rowsById", "filter", "updated", "suspend", "sortAsc", "fastSortField", "sortComparer", "refreshHints", "prevRefreshHints", "filterArgs", "filteredItems", "compiledFilter", "compiledFilterWithCaching", "filterCache", "groupingInfoDefaults", "a", "b", "summaryOptions", "groupingInfos", "groups", "toggledGroupsByLevel", "groupingDelimiter", "page", "totalRows", "onDataChanged", "EventEmitter", "onDataLoading", "onDataLoaded", "onGroupExpanded", "onGroupCollapsed", "onPagingInfoChanged", "onRowCountChanged", "onRowsChanged", "onRowsOrCountChanged", "loading", "errorMessage", "populateLocks", "populateCalls", "contentType", "dataType", "totalCount", "groupItemMetadataProvider", "localSort", "intf", "beginUpdate", "endUpdate", "refresh", "setRefreshHints", "hints", "setFilterArgs", "args", "updateIdxById", "startingIndex", "id", "i", "l", "msg", "ensureIdUniqueness", "getItems", "getIdPropertyName", "setItems", "data", "newIdProperty", "getSortComparer", "recalc", "setPagingOptions", "anyChange", "newPage", "populate", "getPagingInfo", "cols", "asc", "sorts", "s", "field", "sign", "value1", "value2", "result", "sort", "comparer", "ascending", "getLocalSort", "setLocalSort", "value", "fastSort", "oldToString", "reSort", "getFilteredItems", "getFilter", "setFilter", "filterFn", "compileFilter", "compileFilterWithCaching", "getGrouping", "setSummaryOptions", "summary", "idx", "compileAccumulatorLoop", "setGrouping", "getGrandTotals", "agg", "groupingInfo", "GroupItemMetadataProvider", "gi", "extend", "deepClone", "getItemByIdx", "getIdxById", "ensureRowsByIdCache", "getRowByItem", "item", "getRowById", "getItemById", "mapItemsToRows", "itemArray", "row", "mapIdsToRows", "idArray", "mapRowsToIds", "rowArray", "ids", "updateItem", "newId", "insertItem", "insertBefore", "addItem", "deleteItem", "sortedAddItem", "sortedIndex", "sortedUpdateItem", "oldItem", "searchItem", "low", "high", "mid", "getRows", "getLength", "getItem", "calculateTotals", "htmlEncode", "getItemMetadata", "expandCollapseAllGroups", "level", "collapse", "collapseAllGroups", "expandAllGroups", "resolveLevelAndGroupingKey", "arg0", "expandCollapseGroup", "opts", "collapseGroup", "varArgs", "expandGroup", "getGroups", "getOrCreateGroup", "groupsByVal", "val", "parentGroup", "group", "Group", "extractGroups", "r", "addTotals", "totals", "isLeafLevel", "addGroupTotals", "GroupTotals", "groupCollapsed", "toggledGroups", "g", "flattenGroupedRows", "groupedRows", "gl", "j", "jj", "getFunctionInfo", "fn", "fnRegex", "matches", "aggregator", "accumulatorInfo", "filterInfo", "filterBody", "tpl", "fnName", "setFunctionName", "err", "uncompiledFilter", "retval", "ii", "uncompiledFilterWithCaching", "cache", "getFilteredAndPagedItems", "batchFilter", "batchFilterWithCaching", "getRowDiffs", "newRows", "eitherIsNonData", "diff", "from", "to", "rl", "_items", "countBefore", "totalRowsBefore", "syncGridSelection", "grid", "preserveHidden", "preserveHiddenOnSelectionChange", "inHandler", "selectedRowIds", "onSelectedRowIdsChanged", "setSelectedRowIds", "rowIds", "EventData", "update", "selectedRows", "e", "newSelectedRowIds", "existing", "syncGridCellCssStyles", "key", "hashById", "storeCellCssStyles", "hash", "newHash", "subFunc", "addData", "gh", "request", "skip", "dt", "ajaxOptions", "response", "notifyError", "xhr", "status", "ev", "json", "ah", "populateLock", "populateUnlock", "getGroupItemMetadataProvider", "setGroupItemMetadataProvider", "localText"]
}
