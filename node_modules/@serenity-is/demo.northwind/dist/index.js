var Gi=Object.create;var Pt=Object.defineProperty;var No=Object.getOwnPropertyDescriptor;var Qi=Object.getOwnPropertyNames,So=Object.getOwnPropertySymbols,Bi=Object.getPrototypeOf,bo=Object.prototype.hasOwnProperty,Ki=Object.prototype.propertyIsEnumerable;var Ro=(n,i,e)=>i in n?Pt(n,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[i]=e,Eo=(n,i)=>{for(var e in i||(i={}))bo.call(i,e)&&Ro(n,e,i[e]);if(So)for(var e of So(i))Ki.call(i,e)&&Ro(n,e,i[e]);return n};var t=(n,i)=>Pt(n,"name",{value:i,configurable:!0});var Xi=(n,i)=>()=>(i||n((i={exports:{}}).exports,i),i.exports);var Ji=(n,i,e,o)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of Qi(i))!bo.call(n,s)&&s!==e&&Pt(n,s,{get:()=>i[s],enumerable:!(o=No(i,s))||o.enumerable});return n};var Vi=(n,i,e)=>(e=n!=null?Gi(Bi(n)):{},Ji(i||!n||!n.__esModule?Pt(e,"default",{value:n,enumerable:!0}):e,n));var y=(n,i,e,o)=>{for(var s=o>1?void 0:o?No(i,e):i,a=n.length-1,d;a>=0;a--)(d=n[a])&&(s=(o?d(i,e,s):d(s))||s);return o&&s&&Pt(i,e,s),s};var I=(n,i,e)=>new Promise((o,s)=>{var a=N=>{try{m(e.next(N))}catch(le){s(le)}},d=N=>{try{m(e.throw(N))}catch(le){s(le)}},m=N=>N.done?o(N.value):Promise.resolve(N.value).then(a,d);m((e=e.apply(n,i)).next())});var Po=Xi((kr,qr)=>{(function(n,i){typeof kr=="object"&&typeof qr!="undefined"?qr.exports=i():typeof define=="function"&&define.amd?define(i):(n=typeof globalThis!="undefined"?globalThis:n||self,n.DOMPurify=i())})(kr,function(){"use strict";function n(p){return n=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},n(p)}t(n,"_typeof");function i(p,u){return i=Object.setPrototypeOf||t(function(v,x){return v.__proto__=x,v},"_setPrototypeOf"),i(p,u)}t(i,"_setPrototypeOf");function e(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(p){return!1}}t(e,"_isNativeReflectConstruct");function o(p,u,f){return e()?o=Reflect.construct:o=t(function(x,E,_){var C=[null];C.push.apply(C,E);var B=Function.bind.apply(x,C),Et=new B;return _&&i(Et,_.prototype),Et},"_construct"),o.apply(null,arguments)}t(o,"_construct");function s(p,u){return m(p)||le(p,u)||J(p,u)||zo()}t(s,"_slicedToArray");function a(p){return d(p)||N(p)||J(p)||ye()}t(a,"_toConsumableArray");function d(p){if(Array.isArray(p))return b(p)}t(d,"_arrayWithoutHoles");function m(p){if(Array.isArray(p))return p}t(m,"_arrayWithHoles");function N(p){if(typeof Symbol!="undefined"&&p[Symbol.iterator]!=null||p["@@iterator"]!=null)return Array.from(p)}t(N,"_iterableToArray");function le(p,u){var f=p==null?null:typeof Symbol!="undefined"&&p[Symbol.iterator]||p["@@iterator"];if(f!=null){var v=[],x=!0,E=!1,_,C;try{for(f=f.call(p);!(x=(_=f.next()).done)&&(v.push(_.value),!(u&&v.length===u));x=!0);}catch(B){E=!0,C=B}finally{try{!x&&f.return!=null&&f.return()}finally{if(E)throw C}}return v}}t(le,"_iterableToArrayLimit");function J(p,u){if(p){if(typeof p=="string")return b(p,u);var f=Object.prototype.toString.call(p).slice(8,-1);if(f==="Object"&&p.constructor&&(f=p.constructor.name),f==="Map"||f==="Set")return Array.from(p);if(f==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(f))return b(p,u)}}t(J,"_unsupportedIterableToArray");function b(p,u){(u==null||u>p.length)&&(u=p.length);for(var f=0,v=new Array(u);f<u;f++)v[f]=p[f];return v}t(b,"_arrayLikeToArray");function ye(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t(ye,"_nonIterableSpread");function zo(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}t(zo,"_nonIterableRest");function Wo(p,u){var f=typeof Symbol!="undefined"&&p[Symbol.iterator]||p["@@iterator"];if(!f){if(Array.isArray(p)||(f=J(p))||u&&p&&typeof p.length=="number"){f&&(p=f);var v=0,x=t(function(){},"F");return{s:x,n:function(){return v>=p.length?{done:!0}:{done:!1,value:p[v++]}},e:function(B){throw B},f:x}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var E=!0,_=!1,C;return{s:function(){f=f.call(p)},n:function(){var B=f.next();return E=B.done,B},e:function(B){_=!0,C=B},f:function(){try{!E&&f.return!=null&&f.return()}finally{if(_)throw C}}}}t(Wo,"_createForOfIteratorHelper");var Qr=Object.entries,Br=Object.setPrototypeOf,$o=Object.isFrozen,jo=Object.getPrototypeOf,Yo=Object.getOwnPropertyDescriptor,Q=Object.freeze,Y=Object.seal,Zo=Object.create,Kr=typeof Reflect!="undefined"&&Reflect,ar=Kr.apply,sr=Kr.construct;ar||(ar=t(function(u,f,v){return u.apply(f,v)},"apply")),Q||(Q=t(function(u){return u},"freeze")),Y||(Y=t(function(u){return u},"seal")),sr||(sr=t(function(u,f){return o(u,a(f))},"construct"));var ei=W(Array.prototype.forEach),Xr=W(Array.prototype.pop),bt=W(Array.prototype.push),Xt=W(String.prototype.toLowerCase),lr=W(String.prototype.toString),ti=W(String.prototype.match),Z=W(String.prototype.replace),ri=W(String.prototype.indexOf),oi=W(String.prototype.trim),V=W(RegExp.prototype.test),pr=ii(TypeError);function W(p){return function(u){for(var f=arguments.length,v=new Array(f>1?f-1:0),x=1;x<f;x++)v[x-1]=arguments[x];return ar(p,u,v)}}t(W,"unapply");function ii(p){return function(){for(var u=arguments.length,f=new Array(u),v=0;v<u;v++)f[v]=arguments[v];return sr(p,f)}}t(ii,"unconstruct");function g(p,u,f){f=f||Xt,Br&&Br(p,null);for(var v=u.length;v--;){var x=u[v];if(typeof x=="string"){var E=f(x);E!==x&&($o(u)||(u[v]=E),x=E)}p[x]=!0}return p}t(g,"addToSet");function Ye(p){var u=Zo(null),f=Wo(Qr(p)),v;try{for(f.s();!(v=f.n()).done;){var x=s(v.value,2),E=x[0],_=x[1];u[E]=_}}catch(C){f.e(C)}finally{f.f()}return u}t(Ye,"clone");function Jt(p,u){for(;p!==null;){var f=Yo(p,u);if(f){if(f.get)return W(f.get);if(typeof f.value=="function")return W(f.value)}p=jo(p)}function v(x){return console.warn("fallback value for",x),null}return t(v,"fallbackValue"),v}t(Jt,"lookupGetter");var Jr=Q(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),dr=Q(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ur=Q(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ni=Q(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),cr=Q(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ai=Q(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Vr=Q(["#text"]),zr=Q(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),mr=Q(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Wr=Q(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Vt=Q(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),si=Y(/\{\{[\w\W]*|[\w\W]*\}\}/gm),li=Y(/<%[\w\W]*|[\w\W]*%>/gm),pi=Y(/\${[\w\W]*}/gm),di=Y(/^data-[\-\w.\u00B7-\uFFFF]/),ui=Y(/^aria-[\-\w]+$/),ci=Y(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),mi=Y(/^(?:\w+script|data):/i),fi=Y(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),yi=Y(/^html$/i),hi=t(function(){return typeof window=="undefined"?null:window},"getGlobal"),vi=t(function(u,f){if(n(u)!=="object"||typeof u.createPolicy!="function")return null;var v=null,x="data-tt-policy-suffix";f.currentScript&&f.currentScript.hasAttribute(x)&&(v=f.currentScript.getAttribute(x));var E="dompurify"+(v?"#"+v:"");try{return u.createPolicy(E,{createHTML:t(function(C){return C},"createHTML"),createScriptURL:t(function(C){return C},"createScriptURL")})}catch(_){return console.warn("TrustedTypes policy "+E+" could not be created."),null}},"_createTrustedTypesPolicy");function $r(){var p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hi(),u=t(function(r){return $r(r)},"DOMPurify");if(u.version="3.0.1",u.removed=[],!p||!p.document||p.document.nodeType!==9)return u.isSupported=!1,u;var f=p.document,v=p.document,x=p.DocumentFragment,E=p.HTMLTemplateElement,_=p.Node,C=p.Element,B=p.NodeFilter,Et=p.NamedNodeMap,xi=Et===void 0?p.NamedNodeMap||p.MozNamedAttrMap:Et,Di=p.HTMLFormElement,Si=p.DOMParser,zt=p.trustedTypes,Wt=C.prototype,Ri=Jt(Wt,"cloneNode"),Ni=Jt(Wt,"nextSibling"),bi=Jt(Wt,"childNodes"),fr=Jt(Wt,"parentNode");if(typeof E=="function"){var yr=v.createElement("template");yr.content&&yr.content.ownerDocument&&(v=yr.content.ownerDocument)}var ee=vi(zt,f),jr=ee?ee.createHTML(""):"",$t=v,hr=$t.implementation,Ei=$t.createNodeIterator,Ci=$t.createDocumentFragment,Ti=$t.getElementsByTagName,Pi=f.importNode,pe={};u.isSupported=typeof Qr=="function"&&typeof fr=="function"&&hr&&typeof hr.createHTMLDocument!="undefined";var vr=si,gr=li,xr=pi,wi=di,Ii=ui,Li=mi,Yr=fi,Dr=ci,T=null,Zr=g({},[].concat(a(Jr),a(dr),a(ur),a(cr),a(Vr))),P=null,eo=g({},[].concat(a(zr),a(mr),a(Wr),a(Vt))),R=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ct=null,Sr=null,to=!0,Rr=!0,ro=!1,oo=!0,Ze=!1,be=!1,Nr=!1,br=!1,et=!1,jt=!1,Yt=!1,io=!0,no=!1,Ai="user-content-",Er=!0,Tt=!1,tt={},rt=null,ao=g({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),so=null,lo=g({},["audio","video","img","source","image","track"]),Cr=null,po=g({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Zt="http://www.w3.org/1998/Math/MathML",er="http://www.w3.org/2000/svg",he="http://www.w3.org/1999/xhtml",ot=he,Tr=!1,Pr=null,Oi=g({},[Zt,er,he],lr),Ee,_i=["application/xhtml+xml","text/html"],ki="text/html",w,it=null,qi=v.createElement("form"),uo=t(function(r){return r instanceof RegExp||r instanceof Function},"isRegexOrFunction"),wr=t(function(r){it&&it===r||((!r||n(r)!=="object")&&(r={}),r=Ye(r),Ee=_i.indexOf(r.PARSER_MEDIA_TYPE)===-1?Ee=ki:Ee=r.PARSER_MEDIA_TYPE,w=Ee==="application/xhtml+xml"?lr:Xt,T="ALLOWED_TAGS"in r?g({},r.ALLOWED_TAGS,w):Zr,P="ALLOWED_ATTR"in r?g({},r.ALLOWED_ATTR,w):eo,Pr="ALLOWED_NAMESPACES"in r?g({},r.ALLOWED_NAMESPACES,lr):Oi,Cr="ADD_URI_SAFE_ATTR"in r?g(Ye(po),r.ADD_URI_SAFE_ATTR,w):po,so="ADD_DATA_URI_TAGS"in r?g(Ye(lo),r.ADD_DATA_URI_TAGS,w):lo,rt="FORBID_CONTENTS"in r?g({},r.FORBID_CONTENTS,w):ao,Ct="FORBID_TAGS"in r?g({},r.FORBID_TAGS,w):{},Sr="FORBID_ATTR"in r?g({},r.FORBID_ATTR,w):{},tt="USE_PROFILES"in r?r.USE_PROFILES:!1,to=r.ALLOW_ARIA_ATTR!==!1,Rr=r.ALLOW_DATA_ATTR!==!1,ro=r.ALLOW_UNKNOWN_PROTOCOLS||!1,oo=r.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ze=r.SAFE_FOR_TEMPLATES||!1,be=r.WHOLE_DOCUMENT||!1,et=r.RETURN_DOM||!1,jt=r.RETURN_DOM_FRAGMENT||!1,Yt=r.RETURN_TRUSTED_TYPE||!1,br=r.FORCE_BODY||!1,io=r.SANITIZE_DOM!==!1,no=r.SANITIZE_NAMED_PROPS||!1,Er=r.KEEP_CONTENT!==!1,Tt=r.IN_PLACE||!1,Dr=r.ALLOWED_URI_REGEXP||Dr,ot=r.NAMESPACE||he,R=r.CUSTOM_ELEMENT_HANDLING||{},r.CUSTOM_ELEMENT_HANDLING&&uo(r.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(R.tagNameCheck=r.CUSTOM_ELEMENT_HANDLING.tagNameCheck),r.CUSTOM_ELEMENT_HANDLING&&uo(r.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(R.attributeNameCheck=r.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),r.CUSTOM_ELEMENT_HANDLING&&typeof r.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(R.allowCustomizedBuiltInElements=r.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ze&&(Rr=!1),jt&&(et=!0),tt&&(T=g({},a(Vr)),P=[],tt.html===!0&&(g(T,Jr),g(P,zr)),tt.svg===!0&&(g(T,dr),g(P,mr),g(P,Vt)),tt.svgFilters===!0&&(g(T,ur),g(P,mr),g(P,Vt)),tt.mathMl===!0&&(g(T,cr),g(P,Wr),g(P,Vt))),r.ADD_TAGS&&(T===Zr&&(T=Ye(T)),g(T,r.ADD_TAGS,w)),r.ADD_ATTR&&(P===eo&&(P=Ye(P)),g(P,r.ADD_ATTR,w)),r.ADD_URI_SAFE_ATTR&&g(Cr,r.ADD_URI_SAFE_ATTR,w),r.FORBID_CONTENTS&&(rt===ao&&(rt=Ye(rt)),g(rt,r.FORBID_CONTENTS,w)),Er&&(T["#text"]=!0),be&&g(T,["html","head","body"]),T.table&&(g(T,["tbody"]),delete Ct.tbody),Q&&Q(r),it=r)},"_parseConfig"),co=g({},["mi","mo","mn","ms","mtext"]),mo=g({},["foreignobject","desc","title","annotation-xml"]),Ui=g({},["title","style","font","a","script"]),tr=g({},dr);g(tr,ur),g(tr,ni);var Ir=g({},cr);g(Ir,ai);var Fi=t(function(r){var l=fr(r);(!l||!l.tagName)&&(l={namespaceURI:ot,tagName:"template"});var c=Xt(r.tagName),D=Xt(l.tagName);return Pr[r.namespaceURI]?r.namespaceURI===er?l.namespaceURI===he?c==="svg":l.namespaceURI===Zt?c==="svg"&&(D==="annotation-xml"||co[D]):Boolean(tr[c]):r.namespaceURI===Zt?l.namespaceURI===he?c==="math":l.namespaceURI===er?c==="math"&&mo[D]:Boolean(Ir[c]):r.namespaceURI===he?l.namespaceURI===er&&!mo[D]||l.namespaceURI===Zt&&!co[D]?!1:!Ir[c]&&(Ui[c]||!tr[c]):!!(Ee==="application/xhtml+xml"&&Pr[r.namespaceURI]):!1},"_checkValidNamespace"),Ce=t(function(r){bt(u.removed,{element:r});try{r.parentNode.removeChild(r)}catch(l){r.remove()}},"_forceRemove"),Lr=t(function(r,l){try{bt(u.removed,{attribute:l.getAttributeNode(r),from:l})}catch(c){bt(u.removed,{attribute:null,from:l})}if(l.removeAttribute(r),r==="is"&&!P[r])if(et||jt)try{Ce(l)}catch(c){}else try{l.setAttribute(r,"")}catch(c){}},"_removeAttribute"),fo=t(function(r){var l,c;if(br)r="<remove></remove>"+r;else{var D=ti(r,/^[\r\n\t ]+/);c=D&&D[0]}Ee==="application/xhtml+xml"&&ot===he&&(r='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+r+"</body></html>");var k=ee?ee.createHTML(r):r;if(ot===he)try{l=new Si().parseFromString(k,Ee)}catch(U){}if(!l||!l.documentElement){l=hr.createDocument(ot,"template",null);try{l.documentElement.innerHTML=Tr?jr:k}catch(U){}}var j=l.body||l.documentElement;return r&&c&&j.insertBefore(v.createTextNode(c),j.childNodes[0]||null),ot===he?Ti.call(l,be?"html":"body")[0]:be?l.documentElement:j},"_initDocument"),yo=t(function(r){return Ei.call(r.ownerDocument||r,r,B.SHOW_ELEMENT|B.SHOW_COMMENT|B.SHOW_TEXT,null,!1)},"_createIterator"),Mi=t(function(r){return r instanceof Di&&(typeof r.nodeName!="string"||typeof r.textContent!="string"||typeof r.removeChild!="function"||!(r.attributes instanceof xi)||typeof r.removeAttribute!="function"||typeof r.setAttribute!="function"||typeof r.namespaceURI!="string"||typeof r.insertBefore!="function"||typeof r.hasChildNodes!="function")},"_isClobbered"),rr=t(function(r){return n(_)==="object"?r instanceof _:r&&n(r)==="object"&&typeof r.nodeType=="number"&&typeof r.nodeName=="string"},"_isNode"),ve=t(function(r,l,c){pe[r]&&ei(pe[r],function(D){D.call(u,l,c,it)})},"_executeHook"),ho=t(function(r){var l;if(ve("beforeSanitizeElements",r,null),Mi(r))return Ce(r),!0;var c=w(r.nodeName);if(ve("uponSanitizeElement",r,{tagName:c,allowedTags:T}),r.hasChildNodes()&&!rr(r.firstElementChild)&&(!rr(r.content)||!rr(r.content.firstElementChild))&&V(/<[/\w]/g,r.innerHTML)&&V(/<[/\w]/g,r.textContent))return Ce(r),!0;if(!T[c]||Ct[c]){if(!Ct[c]&&go(c)&&(R.tagNameCheck instanceof RegExp&&V(R.tagNameCheck,c)||R.tagNameCheck instanceof Function&&R.tagNameCheck(c)))return!1;if(Er&&!rt[c]){var D=fr(r)||r.parentNode,k=bi(r)||r.childNodes;if(k&&D)for(var j=k.length,U=j-1;U>=0;--U)D.insertBefore(Ri(k[U],!0),Ni(r))}return Ce(r),!0}return r instanceof C&&!Fi(r)||(c==="noscript"||c==="noembed")&&V(/<\/no(script|embed)/i,r.innerHTML)?(Ce(r),!0):(Ze&&r.nodeType===3&&(l=r.textContent,l=Z(l,vr," "),l=Z(l,gr," "),l=Z(l,xr," "),r.textContent!==l&&(bt(u.removed,{element:r.cloneNode()}),r.textContent=l)),ve("afterSanitizeElements",r,null),!1)},"_sanitizeElements"),vo=t(function(r,l,c){if(io&&(l==="id"||l==="name")&&(c in v||c in qi))return!1;if(!(Rr&&!Sr[l]&&V(wi,l))){if(!(to&&V(Ii,l))){if(!P[l]||Sr[l]){if(!(go(r)&&(R.tagNameCheck instanceof RegExp&&V(R.tagNameCheck,r)||R.tagNameCheck instanceof Function&&R.tagNameCheck(r))&&(R.attributeNameCheck instanceof RegExp&&V(R.attributeNameCheck,l)||R.attributeNameCheck instanceof Function&&R.attributeNameCheck(l))||l==="is"&&R.allowCustomizedBuiltInElements&&(R.tagNameCheck instanceof RegExp&&V(R.tagNameCheck,c)||R.tagNameCheck instanceof Function&&R.tagNameCheck(c))))return!1}else if(!Cr[l]){if(!V(Dr,Z(c,Yr,""))){if(!((l==="src"||l==="xlink:href"||l==="href")&&r!=="script"&&ri(c,"data:")===0&&so[r])){if(!(ro&&!V(Li,Z(c,Yr,"")))){if(c)return!1}}}}}}return!0},"_isValidAttribute"),go=t(function(r){return r.indexOf("-")>0},"_basicCustomElementTest"),xo=t(function(r){var l,c,D,k;ve("beforeSanitizeAttributes",r,null);var j=r.attributes;if(j){var U={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:P};for(k=j.length;k--;){l=j[k];var z=l,Te=z.name,Ar=z.namespaceURI;if(c=Te==="value"?l.value:oi(l.value),D=w(Te),U.attrName=D,U.attrValue=c,U.keepAttr=!0,U.forceKeepAttr=void 0,ve("uponSanitizeAttribute",r,U),c=U.attrValue,!U.forceKeepAttr&&(Lr(Te,r),!!U.keepAttr)){if(!oo&&V(/\/>/i,c)){Lr(Te,r);continue}Ze&&(c=Z(c,vr," "),c=Z(c,gr," "),c=Z(c,xr," "));var Do=w(r.nodeName);if(vo(Do,D,c)){if(no&&(D==="id"||D==="name")&&(Lr(Te,r),c=Ai+c),ee&&n(zt)==="object"&&typeof zt.getAttributeType=="function"&&!Ar)switch(zt.getAttributeType(Do,D)){case"TrustedHTML":c=ee.createHTML(c);break;case"TrustedScriptURL":c=ee.createScriptURL(c);break}try{Ar?r.setAttributeNS(Ar,Te,c):r.setAttribute(Te,c),Xr(u.removed)}catch(fl){}}}}ve("afterSanitizeAttributes",r,null)}},"_sanitizeAttributes"),Hi=t(function h(r){var l,c=yo(r);for(ve("beforeSanitizeShadowDOM",r,null);l=c.nextNode();)ve("uponSanitizeShadowNode",l,null),!ho(l)&&(l.content instanceof x&&h(l.content),xo(l));ve("afterSanitizeShadowDOM",r,null)},"_sanitizeShadowDOM");return u.sanitize=function(h){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l,c,D,k;if(Tr=!h,Tr&&(h="<!-->"),typeof h!="string"&&!rr(h)){if(typeof h.toString!="function")throw pr("toString is not a function");if(h=h.toString(),typeof h!="string")throw pr("dirty is not a string, aborting")}if(!u.isSupported)return h;if(Nr||wr(r),u.removed=[],typeof h=="string"&&(Tt=!1),Tt){if(h.nodeName){var j=w(h.nodeName);if(!T[j]||Ct[j])throw pr("root node is forbidden and cannot be sanitized in-place")}}else if(h instanceof _)l=fo("<!---->"),c=l.ownerDocument.importNode(h,!0),c.nodeType===1&&c.nodeName==="BODY"||c.nodeName==="HTML"?l=c:l.appendChild(c);else{if(!et&&!Ze&&!be&&h.indexOf("<")===-1)return ee&&Yt?ee.createHTML(h):h;if(l=fo(h),!l)return et?null:Yt?jr:""}l&&br&&Ce(l.firstChild);for(var U=yo(Tt?h:l);D=U.nextNode();)ho(D)||(D.content instanceof x&&Hi(D.content),xo(D));if(Tt)return h;if(et){if(jt)for(k=Ci.call(l.ownerDocument);l.firstChild;)k.appendChild(l.firstChild);else k=l;return(P.shadowroot||P.shadowrootmod)&&(k=Pi.call(f,k,!0)),k}var z=be?l.outerHTML:l.innerHTML;return be&&T["!doctype"]&&l.ownerDocument&&l.ownerDocument.doctype&&l.ownerDocument.doctype.name&&V(yi,l.ownerDocument.doctype.name)&&(z="<!DOCTYPE "+l.ownerDocument.doctype.name+`>
`+z),Ze&&(z=Z(z,vr," "),z=Z(z,gr," "),z=Z(z,xr," ")),ee&&Yt?ee.createHTML(z):z},u.setConfig=function(h){wr(h),Nr=!0},u.clearConfig=function(){it=null,Nr=!1},u.isValidAttribute=function(h,r,l){it||wr({});var c=w(h),D=w(r);return vo(c,D,l)},u.addHook=function(h,r){typeof r=="function"&&(pe[h]=pe[h]||[],bt(pe[h],r))},u.removeHook=function(h){if(pe[h])return Xr(pe[h])},u.removeHooks=function(h){pe[h]&&(pe[h]=[])},u.removeAllHooks=function(){pe={}},u}t($r,"createDOMPurify");var gi=$r();return gi})});import{Decorators as vs,EntityDialog as gs}from"@serenity-is/corelib";var nt=class{};t(nt,"CategoryColumns"),nt.columnsKey="Northwind.Category";import{StringEditor as zi,PrefixedContext as Wi}from"@serenity-is/corelib";import{initFormType as $i}from"@serenity-is/corelib/q";var wt=class extends Wi{constructor(i){if(super(i),!wt.init){wt.init=!0;var e=zi;$i(wt,["CategoryName",e,"Description",e])}}},Pe=wt;t(Pe,"CategoryForm"),Pe.formKey="Northwind.Category";import{fieldsProxy as ji}from"@serenity-is/corelib/q";var te=class{};t(te,"CategoryLangRow"),te.idProperty="Id",te.nameProperty="CategoryName",te.localTextPrefix="Northwind.CategoryLang",te.deletePermission="Northwind:General",te.insertPermission="Northwind:General",te.readPermission="Northwind:General",te.updatePermission="Northwind:General",te.Fields=ji();import{serviceRequest as Yi}from"@serenity-is/corelib/q";var Co;(e=>(e.baseUrl="Serenity.Demo.Northwind/CategoryLang",e.Methods={Create:"Serenity.Demo.Northwind/CategoryLang/Create",Update:"Serenity.Demo.Northwind/CategoryLang/Update",Delete:"Serenity.Demo.Northwind/CategoryLang/Delete",Retrieve:"Serenity.Demo.Northwind/CategoryLang/Retrieve",List:"Serenity.Demo.Northwind/CategoryLang/List"},["Create","Update","Delete","Retrieve","List"].forEach(o=>{e[o]=function(s,a,d){return Yi(e.baseUrl+"/"+o,s,a,d)}})))(Co||(Co={}));import{getLookup as Zi,getLookupAsync as en,fieldsProxy as tn}from"@serenity-is/corelib/q";var L=class{static getLookup(){return Zi("Northwind.Category")}static getLookupAsync(){return I(this,null,function*(){return en("Northwind.Category")})}};t(L,"CategoryRow"),L.idProperty="CategoryID",L.nameProperty="CategoryName",L.localTextPrefix="Northwind.Category",L.lookupKey="Northwind.Category",L.deletePermission="Northwind:General",L.insertPermission="Northwind:General",L.readPermission="Northwind:General",L.updatePermission="Northwind:General",L.Fields=tn();import{serviceRequest as rn}from"@serenity-is/corelib/q";var at;(e=>(e.baseUrl="Serenity.Demo.Northwind/Category",e.Methods={Create:"Serenity.Demo.Northwind/Category/Create",Update:"Serenity.Demo.Northwind/Category/Update",Delete:"Serenity.Demo.Northwind/Category/Delete",Retrieve:"Serenity.Demo.Northwind/Category/Retrieve",List:"Serenity.Demo.Northwind/Category/List"},["Create","Update","Delete","Retrieve","List"].forEach(o=>{e[o]=function(s,a,d){return rn(e.baseUrl+"/"+o,s,a,d)}})))(at||(at={}));import{Decorators as on}from"@serenity-is/corelib";var Or,_r,st=class{format(i){var e=i.value;if(!e||!e.length)return"";if(!Or)return _r||(_r=K.getLookupAsync().then(s=>{var a;Or=s,(a=i.grid)==null||a.invalidate()}).catch(()=>_r=null)),'<i class="fa fa-spinner"></i>';var o=Or.itemById;return e.map(s=>{var a=o[s];return a==null?s:a.FullName}).join(", ")}};t(st,"EmployeeListFormatter"),st=y([on.registerFormatter("Serenity.Demo.Northwind.EmployeeListFormatter")],st);var lt=class{};t(lt,"CustomerColumns"),lt.columnsKey="Northwind.Customer";import{fieldsProxy as nn}from"@serenity-is/corelib/q";var re=class{};t(re,"CustomerCustomerDemoRow"),re.idProperty="ID",re.nameProperty="CustomerID",re.localTextPrefix="Northwind.CustomerCustomerDemo",re.deletePermission="Northwind:General",re.insertPermission="Northwind:General",re.readPermission="Northwind:General",re.updatePermission="Northwind:General",re.Fields=nn();import{fieldsProxy as an}from"@serenity-is/corelib/q";var oe=class{};t(oe,"CustomerDemographicRow"),oe.idProperty="ID",oe.nameProperty="CustomerTypeID",oe.localTextPrefix="Northwind.CustomerDemographic",oe.deletePermission="Northwind:General",oe.insertPermission="Northwind:General",oe.readPermission="Northwind:General",oe.updatePermission="Northwind:General",oe.Fields=an();import{fieldsProxy as sn}from"@serenity-is/corelib/q";var ie=class{};t(ie,"CustomerDetailsRow"),ie.idProperty="Id",ie.nameProperty="Email",ie.localTextPrefix="Northwind.CustomerDetails",ie.deletePermission="Northwind:General",ie.insertPermission="Northwind:General",ie.readPermission="Northwind:General",ie.updatePermission="Northwind:General",ie.Fields=sn();import{StringEditor as Sn,LookupEditor as Rn,DateEditor as Nn,EmailAddressEditor as bn,BooleanEditor as En,PrefixedContext as Cn}from"@serenity-is/corelib";import{Decorators as wo,IGetEditValue as un,ISetEditValue as cn,TemplatedWidget as mn,Toolbar as fn}from"@serenity-is/corelib";import{Authorization as yn,coalesce as hn,confirmDialog as vn,formatDate as gn,formatISODateTimeUTC as xn,insert as Dn,trimToNull as Io}from"@serenity-is/corelib/q";import{Decorators as ln,HtmlNoteContentEditor as pn,TemplatedDialog as dn}from"@serenity-is/corelib";import{localText as To}from"@serenity-is/corelib/q";var xe=class extends dn{constructor(){super();this.textEditor=new pn(this.byId("Text"))}getTemplate(){return"<form id='~_Form' class='s-Form'><textarea id='~_Text' class='required'></textarea></form>"}getDialogButtons(){return[{text:To("Dialogs.OkButton"),click:()=>{this.validateForm()&&this.okClick&&this.okClick()}},{text:To("Dialogs.CancelButton"),click:()=>this.dialogClose()}]}get text(){return this.textEditor.value}set text(e){this.textEditor.value=e}};t(xe,"NoteDialog"),xe=y([ln.registerClass("Serenity.Demo.Northwind.NoteDialog")],xe);var Lo=Vi(Po(),1);var we=class extends mn{constructor(e){super(e);new fn(this.byId("Toolbar"),{buttons:[{title:"Add Note",cssClass:"add-button",onClick:o=>{o.preventDefault(),this.addClick()}}]})}getTemplate(){return"<div><div id='~_Toolbar'></div><ul id='~_NoteList'></ul></div>"}updateContent(){var e=this.byId("NoteList");if(e.children().remove(),this.items)for(var o=0,s=0;s<this.items.length;s++){var a=this.items[s],d=$("<li/>");$("<div/>").addClass("note-text").html(Lo.sanitize(hn(a.Text,""))).appendTo(d),$("<a/>").attr("href","#").addClass("note-date").text(a.InsertUserDisplayName+" - "+gn(a.InsertDate,"g")).data("index",o).appendTo(d).click(m=>this.editClick(m)),$("<a/>").attr("href","#").addClass("note-delete").attr("title","delete note").data("index",o).appendTo(d).click(m=>this.deleteClick(m)),d.appendTo(e),o++}}addClick(){var e=new xe;e.dialogTitle="Add Note",e.okClick=()=>{var o=Io(e.text);o!=null&&(this.items=this.items||[],Dn(this.items,0,{Text:o,InsertUserDisplayName:yn.userDefinition.DisplayName,InsertDate:xn(new Date)}),this.updateContent(),e.dialogClose(),this.set_isDirty(!0),this.onChange&&this.onChange())},e.dialogOpen()}editClick(e){e.preventDefault();var o=$(e.target).data("index"),s=this.items[o],a=new xe;a.dialogTitle="Edit Note",a.text=s.Text,a.okClick=()=>{var d=Io(a.text);d&&(this.items[o].Text=d,this.updateContent(),a.dialogClose(),this.set_isDirty(!0),this.onChange&&this.onChange())},a.dialogOpen()}deleteClick(e){e.preventDefault();var o=$(e.target).data("index");vn("Delete this note?",()=>{this.items.splice(o,1),this.updateContent(),this.set_isDirty(!0),this.onChange&&this.onChange()})}get value(){return this.items}set value(e){this.items=e||[],this.set_isDirty(!1),this.updateContent()}getEditValue(e,o){o[e.name]=this.value}setEditValue(e,o){this.value=e[o.name]||[]}get_isDirty(){return this.isDirty}set_isDirty(e){this.isDirty=e}};t(we,"NotesEditor"),we=y([wo.registerEditor("Serenity.Demo.Northwind.NotesEditor",[un,cn]),wo.element("<div/>")],we);import{initFormType as Tn}from"@serenity-is/corelib/q";var It=class extends Cn{constructor(i){if(super(i),!It.init){It.init=!0;var e=Sn,o=Rn,s=we,a=Nn,d=bn,m=En;Tn(It,["CustomerID",e,"CompanyName",e,"ContactName",e,"ContactTitle",e,"Representatives",o,"Address",e,"Country",o,"City",o,"Region",e,"PostalCode",e,"Phone",e,"Fax",e,"NoteList",s,"LastContactDate",a,"LastContactedBy",o,"Email",d,"SendBulletin",m])}}},Ie=It;t(Ie,"CustomerForm"),Ie.formKey="Northwind.Customer";import{fieldsProxy as Pn}from"@serenity-is/corelib/q";var de=class{};t(de,"CustomerGrossSalesRow"),de.nameProperty="ContactName",de.localTextPrefix="Northwind.CustomerGrossSales",de.deletePermission="Northwind:General",de.insertPermission="Northwind:General",de.readPermission="Northwind:General",de.updatePermission="Northwind:General",de.Fields=Pn();import{fieldsProxy as wn}from"@serenity-is/corelib/q";var ue=class{};t(ue,"CustomerRepresentativesRow"),ue.idProperty="RepresentativeId",ue.localTextPrefix="Northwind.CustomerRepresentatives",ue.deletePermission="Northwind:Customer:View",ue.insertPermission="Northwind:Customer:View",ue.readPermission="Northwind:Customer:View",ue.updatePermission="Northwind:Customer:View",ue.Fields=wn();import{getLookup as In,getLookupAsync as Ln,fieldsProxy as An}from"@serenity-is/corelib/q";var F=class{static getLookup(){return In("Northwind.Customer")}static getLookupAsync(){return I(this,null,function*(){return Ln("Northwind.Customer")})}};t(F,"CustomerRow"),F.idProperty="ID",F.nameProperty="CompanyName",F.localTextPrefix="Northwind.Customer",F.lookupKey="Northwind.Customer",F.deletePermission="Northwind:Customer:Delete",F.insertPermission="Northwind:Customer:Modify",F.readPermission="Northwind:Customer:View",F.updatePermission="Northwind:Customer:Modify",F.Fields=An();import{serviceRequest as On}from"@serenity-is/corelib/q";var pt;(e=>(e.baseUrl="Serenity.Demo.Northwind/Customer",e.Methods={Create:"Serenity.Demo.Northwind/Customer/Create",Update:"Serenity.Demo.Northwind/Customer/Update",Delete:"Serenity.Demo.Northwind/Customer/Delete",GetNextNumber:"Serenity.Demo.Northwind/Customer/GetNextNumber",Retrieve:"Serenity.Demo.Northwind/Customer/Retrieve",List:"Serenity.Demo.Northwind/Customer/List"},["Create","Update","Delete","GetNextNumber","Retrieve","List"].forEach(o=>{e[o]=function(s,a,d){return On(e.baseUrl+"/"+o,s,a,d)}})))(pt||(pt={}));import{getLookup as _n,getLookupAsync as kn,fieldsProxy as qn}from"@serenity-is/corelib/q";var K=class{static getLookup(){return _n("Northwind.Employee")}static getLookupAsync(){return I(this,null,function*(){return kn("Northwind.Employee")})}};t(K,"EmployeeRow"),K.idProperty="EmployeeID",K.nameProperty="FullName",K.localTextPrefix="Northwind.Employee",K.lookupKey="Northwind.Employee",K.deletePermission="Northwind:General",K.insertPermission="Northwind:General",K.readPermission="Northwind:General",K.updatePermission="Northwind:General",K.Fields=qn();import{fieldsProxy as Un}from"@serenity-is/corelib/q";var ne=class{};t(ne,"EmployeeTerritoryRow"),ne.idProperty="EmployeeID",ne.nameProperty="TerritoryID",ne.localTextPrefix="Northwind.EmployeeTerritory",ne.deletePermission="Northwind:General",ne.insertPermission="Northwind:General",ne.readPermission="Northwind:General",ne.updatePermission="Northwind:General",ne.Fields=Un();import{Decorators as Fn}from"@serenity-is/corelib";var Ur=(e=>(e[e.Male=1]="Male",e[e.Female=2]="Female",e))(Ur||{});Fn.registerEnumType(Ur,"Serenity.Demo.Northwind.Gender");import{fieldsProxy as Mn}from"@serenity-is/corelib/q";var ae=class{};t(ae,"NoteRow"),ae.idProperty="NoteId",ae.nameProperty="EntityType",ae.localTextPrefix="Northwind.Note",ae.deletePermission="Northwind:General",ae.insertPermission="Northwind:General",ae.readPermission="Northwind:General",ae.updatePermission="Northwind:General",ae.Fields=Mn();import{Decorators as Ao,IInitializeColumn as Hn,ISlickFormatter as Gn}from"@serenity-is/corelib";import{htmlEncode as Qn,isTrimmedEmpty as Bn}from"@serenity-is/corelib/q";var Le=class{format(i){var e=Qn(i.value);if(!this.genderProperty||Bn(i.value))return e;var o=i.item[this.genderProperty];return'<i class="fa fa-'+(o===2?"female text-danger":"male text-primary")+' text-opacity-75"></i>'+e}initializeColumn(i){i.referencedFields=i.referencedFields||[],this.genderProperty&&i.referencedFields.push(this.genderProperty)}};t(Le,"EmployeeFormatter"),y([Ao.option()],Le.prototype,"genderProperty",2),Le=y([Ao.registerFormatter("Serenity.Demo.Northwind.EmployeeFormatter",[Gn,Hn])],Le);import{Decorators as Kn}from"@serenity-is/corelib";var Fr=(e=>(e[e.NotShipped=0]="NotShipped",e[e.Shipped=1]="Shipped",e))(Fr||{});Kn.registerEnumType(Fr,"Serenity.Demo.Northwind.OrderShippingState","Northwind.OrderShippingState");import{Decorators as Xn}from"@serenity-is/corelib";import{htmlEncode as Oo}from"@serenity-is/corelib/q";var dt=class{format(i){return i.value?'<i class="text-info fa fa-'+(i.value=="Speedy Express"?"plane":i.value=="Federal Shipping"?"ship":"truck")+' text-opacity-75"></i> '+Oo(i.value):Oo(i.value)}};t(dt,"ShipperFormatter"),dt=y([Xn.registerFormatter("Serenity.Demo.Northwind.ShipperFormatter")],dt);import{Decorators as Jn}from"@serenity-is/corelib";import{htmlEncode as Vn}from"@serenity-is/corelib/q";var ut=class{format(i){return i.value==null?"":Vn(i.value)+' <i class="icon fa fa-balance-scale text-secondary text-opacity-75"></i>'}};t(ut,"FreightFormatter"),ut=y([Jn.registerFormatter("Serenity.Demo.Northwind.FreightFormatter")],ut);var ct=class{};t(ct,"OrderColumns"),ct.columnsKey="Northwind.Order";var mt=class{};t(mt,"OrderDetailColumns"),mt.columnsKey="Northwind.OrderDetail";import{LookupEditor as zn,DecimalEditor as Wn,IntegerEditor as $n,PrefixedContext as jn}from"@serenity-is/corelib";import{initFormType as Yn}from"@serenity-is/corelib/q";var Lt=class extends jn{constructor(i){if(super(i),!Lt.init){Lt.init=!0;var e=zn,o=Wn,s=$n;Yn(Lt,["ProductID",e,"UnitPrice",o,"Quantity",s,"Discount",o])}}},Ae=Lt;t(Ae,"OrderDetailForm"),Ae.formKey="Northwind.OrderDetail";import{fieldsProxy as Zn}from"@serenity-is/corelib/q";var X=class{};t(X,"OrderDetailRow"),X.idProperty="DetailID",X.localTextPrefix="Northwind.OrderDetail",X.deletePermission="Northwind:General",X.insertPermission="Northwind:General",X.readPermission="Northwind:General",X.updatePermission="Northwind:General",X.Fields=Zn();import{serviceRequest as ea}from"@serenity-is/corelib/q";var _o;(e=>(e.baseUrl="Serenity.Demo.Northwind/OrderDetail",e.Methods={Retrieve:"Serenity.Demo.Northwind/OrderDetail/Retrieve",List:"Serenity.Demo.Northwind/OrderDetail/List"},["Retrieve","List"].forEach(o=>{e[o]=function(s,a,d){return ea(e.baseUrl+"/"+o,s,a,d)}})))(_o||(_o={}));import{Decorators as ta,LookupEditorBase as ra}from"@serenity-is/corelib";var Oe=class extends ra{constructor(i,e){super(i,Eo({async:!0},e))}getLookupKey(){return"Northwind.Customer"}getItemText(i,e){return super.getItemText(i,e)+" ["+i.CustomerID+"]"}};t(Oe,"CustomerEditor"),Oe=y([ta.registerEditor("Serenity.Demo.Northwind.CustomerEditor")],Oe);import{DateEditor as ua,LookupEditor as ca,DecimalEditor as ma,StringEditor as fa,PrefixedContext as ya}from"@serenity-is/corelib";import{Decorators as aa}from"@serenity-is/corelib";import{alertDialog as sa,toId as la,tryFirst as pa}from"@serenity-is/corelib/q";import{GridEditorBase as da}from"@serenity-is/extensions";import{Decorators as oa}from"@serenity-is/corelib";import{toId as ia}from"@serenity-is/corelib/q";import{GridEditorDialog as na}from"@serenity-is/extensions";var _e=class extends na{constructor(){super();this.form=new Ae(this.idPrefix),this.form.ProductID.changeSelect2(e=>I(this,null,function*(){var o=ia(this.form.ProductID.value);o!=null&&(this.form.UnitPrice.value=(yield S.getLookupAsync()).itemById[o].UnitPrice)})),this.form.Discount.addValidationRule(this.uniqueName,e=>{var o=this.form.UnitPrice.value,s=this.form.Quantity.value,a=this.form.Discount.value;if(o!=null&&s!=null&&a!=null&&a>0&&a>=o*s)return"Discount can't be higher than total price!"})}getFormKey(){return Ae.formKey}getLocalTextPrefix(){return X.localTextPrefix}};t(_e,"OrderDetailDialog"),_e=y([oa.registerClass()],_e);var ke=class extends da{getColumnsKey(){return mt.columnsKey}getDialogType(){return _e}getLocalTextPrefix(){return X.localTextPrefix}constructor(i){super(i)}validateEntity(i,e){i.ProductID=la(i.ProductID);var o=pa(this.view.getItems(),s=>s.ProductID===i.ProductID);return o&&this.id(o)!==e?(sa("This product is already in order details!"),!1):(e!=null||(e=i[this.getIdProperty()]),S.getLookupAsync().then(s=>{var d,m;var a=(m=(d=this.view)==null?void 0:d.getItemById)==null?void 0:m.call(d,e);a&&(a.ProductName=s.itemById[i.ProductID].ProductName,this.view.updateItem(e,a))}),i.LineTotal=(i.Quantity||0)*(i.UnitPrice||0)-(i.Discount||0),!0)}};t(ke,"OrderDetailsEditor"),ke=y([aa.registerEditor("Serenity.Demo.Northwind.OrderDetailsEditor")],ke);import{initFormType as ha}from"@serenity-is/corelib/q";var At=class extends ya{constructor(i){if(super(i),!At.init){At.init=!0;var e=Oe,o=ua,s=ca,a=ke,d=ma,m=fa;ha(At,["CustomerID",e,"OrderDate",o,"RequiredDate",o,"EmployeeID",s,"DetailList",a,"ShippedDate",o,"ShipVia",s,"Freight",d,"ShipName",m,"ShipAddress",m,"ShipCity",m,"ShipRegion",m,"ShipPostalCode",m,"ShipCountry",m])}}},qe=At;t(qe,"OrderForm"),qe.formKey="Northwind.Order";import{fieldsProxy as va}from"@serenity-is/corelib/q";var A=class{};t(A,"OrderRow"),A.idProperty="OrderID",A.nameProperty="CustomerID",A.localTextPrefix="Northwind.Order",A.deletePermission="Northwind:General",A.insertPermission="Northwind:General",A.readPermission="Northwind:General",A.updatePermission="Northwind:General",A.Fields=va();import{serviceRequest as ga}from"@serenity-is/corelib/q";var Ue;(e=>(e.baseUrl="Serenity.Demo.Northwind/Order",e.Methods={Create:"Serenity.Demo.Northwind/Order/Create",Update:"Serenity.Demo.Northwind/Order/Update",Delete:"Serenity.Demo.Northwind/Order/Delete",Retrieve:"Serenity.Demo.Northwind/Order/Retrieve",List:"Serenity.Demo.Northwind/Order/List"},["Create","Update","Delete","Retrieve","List"].forEach(o=>{e[o]=function(s,a,d){return ga(e.baseUrl+"/"+o,s,a,d)}})))(Ue||(Ue={}));var ko;(e=>{e.General="Northwind:General";let i;(d=>(d.Delete="Northwind:Customer:Delete",d.Modify="Northwind:Customer:Modify",d.View="Northwind:Customer:View"))(i=e.Customer||(e.Customer={}))})(ko||(ko={}));var ft=class{};t(ft,"ProductColumns"),ft.columnsKey="Northwind.Product";import{StringEditor as Sa,ImageUploadEditor as Ra,BooleanEditor as Na,LookupEditor as ba,DecimalEditor as Ea,IntegerEditor as Ca,PrefixedContext as Ta}from"@serenity-is/corelib";import{Decorators as xa,EntityDialog as Da}from"@serenity-is/corelib";var De=class extends Da{constructor(){super(...arguments);this.form=new Fe(this.idPrefix)}getFormKey(){return Fe.formKey}getRowDefinition(){return O}getService(){return yt.baseUrl}};t(De,"SupplierDialog"),De=y([xa.registerClass("Serenity.Demo.Northwind.SupplierDialog")],De);import{initFormType as Pa}from"@serenity-is/corelib/q";var Ot=class extends Ta{constructor(i){if(super(i),!Ot.init){Ot.init=!0;var e=Sa,o=Ra,s=Na,a=ba,d=Ea,m=Ca;Pa(Ot,["ProductName",e,"ProductImage",o,"Discontinued",s,"SupplierID",a,"CategoryID",a,"QuantityPerUnit",e,"UnitPrice",d,"UnitsInStock",m,"UnitsOnOrder",m,"ReorderLevel",m])}}},Me=Ot;t(Me,"ProductForm"),Me.formKey="Northwind.Product";import{fieldsProxy as wa}from"@serenity-is/corelib/q";var se=class{};t(se,"ProductLangRow"),se.idProperty="Id",se.nameProperty="ProductName",se.localTextPrefix="Northwind.ProductLang",se.deletePermission="Northwind:General",se.insertPermission="Northwind:General",se.readPermission="Northwind:General",se.updatePermission="Northwind:General",se.Fields=wa();import{serviceRequest as Ia}from"@serenity-is/corelib/q";var qo;(e=>(e.baseUrl="Serenity.Demo.Northwind/ProductLang",e.Methods={Create:"Serenity.Demo.Northwind/ProductLang/Create",Update:"Serenity.Demo.Northwind/ProductLang/Update",Delete:"Serenity.Demo.Northwind/ProductLang/Delete",Retrieve:"Serenity.Demo.Northwind/ProductLang/Retrieve",List:"Serenity.Demo.Northwind/ProductLang/List"},["Create","Update","Delete","Retrieve","List"].forEach(o=>{e[o]=function(s,a,d){return Ia(e.baseUrl+"/"+o,s,a,d)}})))(qo||(qo={}));import{fieldsProxy as La}from"@serenity-is/corelib/q";var ce=class{};t(ce,"ProductLogRow"),ce.idProperty="ProductLogID",ce.localTextPrefix="Northwind.ProductLog",ce.deletePermission=null,ce.insertPermission=null,ce.readPermission="",ce.updatePermission=null,ce.Fields=La();import{getLookup as Aa,getLookupAsync as Oa,fieldsProxy as _a}from"@serenity-is/corelib/q";var S=class{static getLookup(){return Aa("Northwind.Product")}static getLookupAsync(){return I(this,null,function*(){return Oa("Northwind.Product")})}};t(S,"ProductRow"),S.idProperty="ProductID",S.nameProperty="ProductName",S.localTextPrefix="Northwind.Product",S.lookupKey="Northwind.Product",S.deletePermission="Northwind:General",S.insertPermission="Northwind:General",S.readPermission="Northwind:General",S.updatePermission="Northwind:General",S.Fields=_a();import{serviceRequest as ka}from"@serenity-is/corelib/q";var Re;(e=>(e.baseUrl="Serenity.Demo.Northwind/Product",e.Methods={Create:"Serenity.Demo.Northwind/Product/Create",Update:"Serenity.Demo.Northwind/Product/Update",Delete:"Serenity.Demo.Northwind/Product/Delete",Retrieve:"Serenity.Demo.Northwind/Product/Retrieve",List:"Serenity.Demo.Northwind/Product/List"},["Create","Update","Delete","Retrieve","List"].forEach(o=>{e[o]=function(s,a,d){return ka(e.baseUrl+"/"+o,s,a,d)}})))(Re||(Re={}));var ht=class{};t(ht,"RegionColumns"),ht.columnsKey="Northwind.Region";import{IntegerEditor as qa,StringEditor as Ua,PrefixedContext as Fa}from"@serenity-is/corelib";import{initFormType as Ma}from"@serenity-is/corelib/q";var _t=class extends Fa{constructor(i){if(super(i),!_t.init){_t.init=!0;var e=qa,o=Ua;Ma(_t,["RegionID",e,"RegionDescription",o])}}},He=_t;t(He,"RegionForm"),He.formKey="Northwind.Region";import{getLookup as Ha,getLookupAsync as Ga,fieldsProxy as Qa}from"@serenity-is/corelib/q";var M=class{static getLookup(){return Ha("Northwind.Region")}static getLookupAsync(){return I(this,null,function*(){return Ga("Northwind.Region")})}};t(M,"RegionRow"),M.idProperty="RegionID",M.nameProperty="RegionDescription",M.localTextPrefix="Northwind.Region",M.lookupKey="Northwind.Region",M.deletePermission="Northwind:General",M.insertPermission="Northwind:General",M.readPermission="Northwind:General",M.updatePermission="Northwind:General",M.Fields=Qa();import{serviceRequest as Ba}from"@serenity-is/corelib/q";var vt;(e=>(e.baseUrl="Serenity.Demo.Northwind/Region",e.Methods={Create:"Serenity.Demo.Northwind/Region/Create",Update:"Serenity.Demo.Northwind/Region/Update",Delete:"Serenity.Demo.Northwind/Region/Delete",Retrieve:"Serenity.Demo.Northwind/Region/Retrieve",List:"Serenity.Demo.Northwind/Region/List"},["Create","Update","Delete","Retrieve","List"].forEach(o=>{e[o]=function(s,a,d){return Ba(e.baseUrl+"/"+o,s,a,d)}})))(vt||(vt={}));var or=class{};t(or,"SalesByCategoryColumns"),or.columnsKey="Northwind.SalesByCategory";import{fieldsProxy as Ka}from"@serenity-is/corelib/q";var me=class{};t(me,"SalesByCategoryRow"),me.nameProperty="CategoryName",me.localTextPrefix="Northwind.SalesByCategory",me.deletePermission="Northwind:General",me.insertPermission="Northwind:General",me.readPermission="Northwind:General",me.updatePermission="Northwind:General",me.Fields=Ka();import{serviceRequest as Xa}from"@serenity-is/corelib/q";var Uo;(e=>(e.baseUrl="Serenity.Demo.Northwind/SalesByCategory",e.Methods={List:"Serenity.Demo.Northwind/SalesByCategory/List"},["List"].forEach(o=>{e[o]=function(s,a,d){return Xa(e.baseUrl+"/"+o,s,a,d)}})))(Uo||(Uo={}));var gt=class{};t(gt,"ShipperColumns"),gt.columnsKey="Northwind.Shipper";import{StringEditor as Wa,PrefixedContext as $a}from"@serenity-is/corelib";import{Decorators as Fo,StringEditor as Ja,WX as Va}from"@serenity-is/corelib";import{isEmptyOrNull as Mo,replaceAll as Ne,startsWith as ir,localText as za,trimToNull as Mr}from"@serenity-is/corelib/q";var q=class extends Ja{constructor(e){super(e);this.addValidationRule(this.uniqueName,o=>{var s=Mr(this.get_value());return s==null?null:q.validate(s,this.multiple)}),e.bind("change",o=>{Va.hasOriginalEvent(o)&&this.formatValue()}),e.bind("blur",o=>{this.element.hasClass("valid")&&this.formatValue()})}formatValue(){this.element.val(this.getFormattedValue())}getFormattedValue(){var e=this.element.val();return this.multiple?q.formatMulti(e,q.formatPhone):q.formatPhone(e)}get_value(){return this.getFormattedValue()}set_value(e){this.element.val(e)}static validate(e,o){var s=o?q.isValidMulti(e,q.isValidPhone):q.isValidPhone(e);return s?null:za(o?"Validation.NorthwindPhoneMultiple":"Validation.NorthwindPhone")}static isValidPhone(e){if(Mo(e)||(e=Ne(Ne(e," ",""),"-",""),e.length<10)||(ir(e,"0")&&(e=e.substring(1)),ir(e,"(")&&e.charAt(4)===")"&&(e=e.substr(1,3)+e.substring(5)),e.length!==10)||ir(e,"0"))return!1;for(var o=0;o<e.length;o++){var s=e.charAt(o);if(s<"0"||s>"9")return!1}return!0}static formatPhone(e){return q.isValidPhone(e)&&(e=Ne(Ne(Ne(Ne(e," ",""),"-",""),"(",""),")",""),ir(e,"0")&&(e=e.substring(1)),e="("+e.substr(0,3)+") "+e.substr(3,3)+"-"+e.substr(6,2)+e.substr(8,2)),e}static formatMulti(e,o){var s=Ne(e,String.fromCharCode(59),String.fromCharCode(44)).split(String.fromCharCode(44)),a="";for(var d of s){var m=Mr(d);m!=null&&(a.length>0&&(a+=", "),a+=o(m))}return a}static isValidMulti(e,o){if(Mo(e))return!1;for(var s=Ne(e,String.fromCharCode(59),String.fromCharCode(44)).split(String.fromCharCode(44)),a=!1,d=0;d<s.length;d++){var m=s[d],N=Mr(m);if(N!=null){if(!o(N))return!1;a=!0}}return!!a}};t(q,"PhoneEditor"),y([Fo.option()],q.prototype,"multiple",2),q=y([Fo.registerEditor("Serenity.Demo.Northwind.PhoneEditor")],q);import{initFormType as ja}from"@serenity-is/corelib/q";var kt=class extends $a{constructor(i){if(super(i),!kt.init){kt.init=!0;var e=Wa,o=q;ja(kt,["CompanyName",e,"Phone",o])}}},Ge=kt;t(Ge,"ShipperForm"),Ge.formKey="Northwind.Shipper";import{getLookup as Ya,getLookupAsync as Za,fieldsProxy as es}from"@serenity-is/corelib/q";var H=class{static getLookup(){return Ya("Northwind.Shipper")}static getLookupAsync(){return I(this,null,function*(){return Za("Northwind.Shipper")})}};t(H,"ShipperRow"),H.idProperty="ShipperID",H.nameProperty="CompanyName",H.localTextPrefix="Northwind.Shipper",H.lookupKey="Northwind.Shipper",H.deletePermission="Northwind:General",H.insertPermission="Northwind:General",H.readPermission="Northwind:General",H.updatePermission="Northwind:General",H.Fields=es();import{serviceRequest as ts}from"@serenity-is/corelib/q";var xt;(e=>(e.baseUrl="Serenity.Demo.Northwind/Shipper",e.Methods={Create:"Serenity.Demo.Northwind/Shipper/Create",Update:"Serenity.Demo.Northwind/Shipper/Update",Delete:"Serenity.Demo.Northwind/Shipper/Delete",Retrieve:"Serenity.Demo.Northwind/Shipper/Retrieve",List:"Serenity.Demo.Northwind/Shipper/List"},["Create","Update","Delete","Retrieve","List"].forEach(o=>{e[o]=function(s,a,d){return ts(e.baseUrl+"/"+o,s,a,d)}})))(xt||(xt={}));var Dt=class{};t(Dt,"SupplierColumns"),Dt.columnsKey="Northwind.Supplier";import{StringEditor as rs,PrefixedContext as os}from"@serenity-is/corelib";import{initFormType as is}from"@serenity-is/corelib/q";var qt=class extends os{constructor(i){if(super(i),!qt.init){qt.init=!0;var e=rs;is(qt,["CompanyName",e,"ContactName",e,"ContactTitle",e,"Address",e,"Region",e,"PostalCode",e,"Country",e,"City",e,"Phone",e,"Fax",e,"HomePage",e])}}},Fe=qt;t(Fe,"SupplierForm"),Fe.formKey="Northwind.Supplier";import{getLookup as ns,getLookupAsync as as,fieldsProxy as ss}from"@serenity-is/corelib/q";var O=class{static getLookup(){return ns("Northwind.Supplier")}static getLookupAsync(){return I(this,null,function*(){return as("Northwind.Supplier")})}};t(O,"SupplierRow"),O.idProperty="SupplierID",O.nameProperty="CompanyName",O.localTextPrefix="Northwind.Supplier",O.lookupKey="Northwind.Supplier",O.deletePermission="Northwind:General",O.insertPermission="Northwind:General",O.readPermission="Northwind:General",O.updatePermission="Northwind:General",O.Fields=ss();import{serviceRequest as ls}from"@serenity-is/corelib/q";var yt;(e=>(e.baseUrl="Serenity.Demo.Northwind/Supplier",e.Methods={Create:"Serenity.Demo.Northwind/Supplier/Create",Update:"Serenity.Demo.Northwind/Supplier/Update",Delete:"Serenity.Demo.Northwind/Supplier/Delete",Retrieve:"Serenity.Demo.Northwind/Supplier/Retrieve",List:"Serenity.Demo.Northwind/Supplier/List"},["Create","Update","Delete","Retrieve","List"].forEach(o=>{e[o]=function(s,a,d){return ls(e.baseUrl+"/"+o,s,a,d)}})))(yt||(yt={}));var St=class{};t(St,"TerritoryColumns"),St.columnsKey="Northwind.Territory";import{StringEditor as ps,LookupEditor as ds,PrefixedContext as us}from"@serenity-is/corelib";import{initFormType as cs}from"@serenity-is/corelib/q";var Ut=class extends us{constructor(i){if(super(i),!Ut.init){Ut.init=!0;var e=ps,o=ds;cs(Ut,["TerritoryID",e,"TerritoryDescription",e,"RegionID",o])}}},Qe=Ut;t(Qe,"TerritoryForm"),Qe.formKey="Northwind.Territory";import{getLookup as ms,getLookupAsync as fs,fieldsProxy as ys}from"@serenity-is/corelib/q";var G=class{static getLookup(){return ms("Northwind.Territory")}static getLookupAsync(){return I(this,null,function*(){return fs("Northwind.Territory")})}};t(G,"TerritoryRow"),G.idProperty="ID",G.nameProperty="TerritoryID",G.localTextPrefix="Northwind.Territory",G.lookupKey="Northwind.Territory",G.deletePermission="Northwind:General",G.insertPermission="Northwind:General",G.readPermission="Northwind:General",G.updatePermission="Northwind:General",G.Fields=ys();import{serviceRequest as hs}from"@serenity-is/corelib/q";var Rt;(e=>(e.baseUrl="Serenity.Demo.Northwind/Territory",e.Methods={Create:"Serenity.Demo.Northwind/Territory/Create",Update:"Serenity.Demo.Northwind/Territory/Update",Delete:"Serenity.Demo.Northwind/Territory/Delete",Retrieve:"Serenity.Demo.Northwind/Territory/Retrieve",List:"Serenity.Demo.Northwind/Territory/List"},["Create","Update","Delete","Retrieve","List"].forEach(o=>{e[o]=function(s,a,d){return hs(e.baseUrl+"/"+o,s,a,d)}})))(Rt||(Rt={}));var Se=class extends gs{constructor(){super(...arguments);this.form=new Pe(this.idPrefix)}getFormKey(){return Pe.formKey}getRowDefinition(){return L}getService(){return at.baseUrl}};t(Se,"CategoryDialog"),Se=y([vs.registerClass("Serenity.Demo.Northwind.CategoryDialog")],Se);import{Decorators as xs,EntityGrid as Ds}from"@serenity-is/corelib";var Ft=class extends Ds{getColumnsKey(){return nt.columnsKey}getDialogType(){return Se}getRowDefinition(){return L}getService(){return at.baseUrl}};t(Ft,"CategoryGrid"),Ft=y([xs.registerClass("Serenity.Demo.Northwind.CategoryGrid")],Ft);import{Decorators as Qo,EntityDialog as qs,TabsExtensions as Us}from"@serenity-is/corelib";import{htmlEncode as Hr,reloadLookup as Fs,localText as Gr}from"@serenity-is/corelib/q";import{DialogUtils as Ms}from"@serenity-is/extensions";import{Decorators as Os,SubDialogHelper as _s}from"@serenity-is/corelib";import{Decorators as Go,EntityGrid as Ns,EnumEditor as bs,LookupEditor as Es}from"@serenity-is/corelib";import{toId as Cs}from"@serenity-is/corelib/q";import{ExcelExportHelper as Ts,PdfExportHelper as Ps,ReportHelper as ws}from"@serenity-is/extensions";import{Decorators as Ho,EntityDialog as Ss}from"@serenity-is/corelib";import{ReportHelper as Rs}from"@serenity-is/extensions";var ge=class extends Ss{constructor(){super();this.form=new qe(this.idPrefix)}getFormKey(){return qe.formKey}getRowDefinition(){return A}getService(){return Ue.baseUrl}getToolbarButtons(){var e=super.getToolbarButtons();return e.push(Rs.createToolButton({title:"Invoice",cssClass:"export-pdf-button",reportKey:"Northwind.OrderDetail",getParams:()=>({OrderID:this.get_entityId()})})),e}updateInterface(){super.updateInterface(),this.toolbar.findButton("export-pdf-button").toggle(this.isEditMode())}};t(ge,"OrderDialog"),ge=y([Ho.registerClass("Serenity.Demo.Northwind.OrderDialog"),Ho.panel()],ge);var Is=A.Fields,Be=class extends Ns{constructor(e){super(e)}getColumnsKey(){return ct.columnsKey}getDialogType(){return ge}getRowDefinition(){return A}getService(){return Ue.baseUrl}getQuickFilters(){var e=super.getQuickFilters();return e.push({type:Es,options:{lookupKey:S.lookupKey,async:!0},field:"ProductID",title:"Contains Product in Details",handler:o=>{this.view.params.ProductID=Cs(o.value)},cssClass:"hidden-xs"}),e}createQuickFilters(){super.createQuickFilters(),this.shippingStateFilter=this.findQuickFilter(bs,Is.ShippingState)}getButtons(){var e=super.getButtons();return e.push(Ts.createToolButton({grid:this,service:Ue.baseUrl+"/ListExcel",onViewSubmit:()=>this.onViewSubmit(),separator:!0})),e.push(Ps.createToolButton({grid:this,onViewSubmit:()=>this.onViewSubmit()})),e}getColumns(){var e=super.getColumns();return e.splice(1,0,{id:"Print Invoice",field:null,name:"",cssClass:"align-center",format:o=>'<a class="inline-action print-invoice" title="invoice"><i class="fa fa-file-pdf-o text-red"></i></a>',width:36,minWidth:36,maxWidth:36}),e}onClick(e,o,s){if(super.onClick(e,o,s),!e.isDefaultPrevented()){var a=this.itemAt(o),d=$(e.target);d.parent().hasClass("inline-action")&&(d=d.parent()),d.hasClass("inline-action")&&(e.preventDefault(),d.hasClass("print-invoice")&&ws.execute({reportKey:"Northwind.OrderDetail",params:{OrderID:a.OrderID}}))}}set_shippingState(e){this.shippingStateFilter.value=e==null?"":e.toString()}addButtonClick(){var e=this.view.params.EqualityFilter;this.editItem({CustomerID:e?e.CustomerID:null})}};t(Be,"OrderGrid"),Be=y([Go.registerClass("Serenity.Demo.Northwind.OrderGrid"),Go.filterable()],Be);import{Decorators as Ls,EditorUtils as As}from"@serenity-is/corelib";var Ke=class extends ge{updateInterface(){super.updateInterface(),As.setReadOnly(this.form.CustomerID,!0)}};t(Ke,"CustomerOrderDialog"),Ke=y([Ls.registerClass("Serenity.Demo.Northwind.CustomerOrderDialog")],Ke);var ks=A.Fields,Xe=class extends Be{constructor(e){super(e)}getDialogType(){return Ke}getColumns(){return super.getColumns().filter(e=>e.field!==ks.CustomerCompanyName)}initEntityDialog(e,o){super.initEntityDialog(e,o),_s.cascade(o,this.element.closest(".ui-dialog"))}addButtonClick(){this.editItem({CustomerID:this.customerID})}getInitialTitle(){return null}getGridCanLoad(){return super.getGridCanLoad()&&!!this.customerID}get customerID(){return this._customerID}set customerID(e){this._customerID!==e&&(this._customerID=e,this.setEquality("CustomerID",e),this.refresh())}};t(Xe,"CustomerOrdersGrid"),Xe=y([Os.registerClass()],Xe);var Je=class extends qs{constructor(){super();this.form=new Ie(this.idPrefix);this.ordersGrid=new Xe(this.byId("OrdersGrid")),this.ordersGrid.openDialogsAsPanel=!1,this.byId("NoteList").closest(".field").hide().end().appendTo(this.byId("TabNotes")),Ms.pendingChangesConfirmation(this.element,()=>this.getSaveState()!=this.loadedState)}getFormKey(){return Ie.formKey}getRowDefinition(){return F}getService(){return pt.baseUrl}getSaveState(){try{return $.toJSON(this.getSaveEntity())}catch(e){return null}}loadResponse(e){super.loadResponse(e),this.loadedState=this.getSaveState()}loadEntity(e){super.loadEntity(e),Us.setDisabled(this.tabs,"Orders",this.isNewOrDeleted()),this.ordersGrid.customerID=e.CustomerID}onSaveSuccess(e){super.onSaveSuccess(e),Fs("Northwind.Customer")}getTemplate(){return`<div id="~_Tabs" class="s-DialogContent">
    <ul>
        <li><a href="#~_TabInfo"><span>${Hr(Gr("Db.Northwind.Customer.EntitySingular"))}</span></a></li>
        <li><a href="#~_TabNotes"><span>${Hr(Gr("Db.Northwind.Note.EntityPlural"))}</span></a></li>
        <li><a href="#~_TabOrders"><span>${Hr(Gr("Db.Northwind.Order.EntityPlural"))}</span></a></li>
    </ul>
    <div id="~_TabInfo" class="tab-pane s-TabInfo">
        <div id="~_Toolbar" class="s-DialogToolbar">
        </div>
        <div class="s-Form">
            <form id="~_Form" action="">
                <div class="fieldset ui-widget ui-widget-content ui-corner-all">
                    <div id="~_PropertyGrid"></div>
                    <div class="clear"></div>
                </div>
            </form>
        </div>
    </div>
    <div id="~_TabNotes" class="tab-pane s-TabNotes">
    </div>
    <div id="~_TabOrders" class="tab-pane s-TabOrders">
        <div id="~_OrdersGrid">
        </div>
    </div>
</div>`}};t(Je,"CustomerDialog"),Je=y([Qo.registerClass("Serenity.Demo.Northwind.CustomerDialog"),Qo.panel()],Je);import{Decorators as Bo,EntityGrid as Hs}from"@serenity-is/corelib";var Mt=class extends Hs{getColumnsKey(){return lt.columnsKey}getDialogType(){return Je}getRowDefinition(){return F}getService(){return pt.baseUrl}};t(Mt,"CustomerGrid"),Mt=y([Bo.registerClass("Serenity.Demo.Norhtwind.CustomerGrid"),Bo.filterable()],Mt);import{Decorators as Ko,EntityDialog as Gs}from"@serenity-is/corelib";var Ve=class extends Gs{constructor(){super(...arguments);this.form=new Me(this.idPrefix)}getFormKey(){return Me.formKey}getRowDefinition(){return S}getService(){return Re.baseUrl}};t(Ve,"ProductDialog"),Ve=y([Ko.registerClass(),Ko.maximizable()],Ve);import{Decorators as Xo,EntityGrid as Qs,LookupEditor as Bs}from"@serenity-is/corelib";import{deepClone as Ks,first as ze,formatNumber as nr,htmlEncode as Nt,notifyError as Jo,parseDecimal as Xs,parseInteger as Js,parseQueryString as Vs,serviceRequest as zs,localText as Vo,toId as Ws,trimToNull as $s,tryFirst as js}from"@serenity-is/corelib/q";import{ExcelExportHelper as Ys,PdfExportHelper as Zs}from"@serenity-is/extensions";var fe=S.Fields,Ht=class extends Qs{constructor(e){super(e);this.pendingChanges={};this.slickContainer.on("change",".edit:input",o=>this.inputsChange(o))}getColumnsKey(){return ft.columnsKey}getDialogType(){return Ve}getRowDefinition(){return S}getService(){return Re.baseUrl}getButtons(){var e=super.getButtons();return e.push(Ys.createToolButton({grid:this,service:Re.baseUrl+"/ListExcel",onViewSubmit:()=>this.onViewSubmit(),separator:!0})),e.push(Zs.createToolButton({grid:this,onViewSubmit:()=>this.onViewSubmit(),reportTitle:"Product List",columnTitles:{Discontinued:"Dis."},tableOptions:{columnStyles:{ProductID:{cellWidth:25,halign:"right"},Discountinued:{cellWidth:25}}}})),e.push({title:"Save Changes",cssClass:"apply-changes-button disabled",onClick:o=>this.saveClick(),separator:!0}),e}onViewProcessData(e){return this.pendingChanges={},this.setSaveButtonState(),super.onViewProcessData(e)}numericInputFormatter(e){if(e.item.__nonDataRow)return Nt(nr(e.value,"#0.##"));var o="edit numeric",s=e.item,a=this.pendingChanges[s.ProductID];a&&a[e.column.field]!==void 0&&(o+=" dirty");var d=this.getEffectiveValue(s,e.column.field);return"<input type='text' class='"+o+"' data-field='"+e.column.field+"' value='"+nr(d,"0.##")+"'/>"}stringInputFormatter(e){if(e.item.__nonDataRow)return Nt(e.value);var o="edit string",s=e.item,a=this.pendingChanges[s.ProductID],d=e.column;a&&a[d.field]!==void 0&&(o+=" dirty");var m=this.getEffectiveValue(s,d.field);return"<input type='text' class='"+o+"' data-field='"+d.field+"' value='"+Nt(m)+"' maxlength='"+d.sourceItem.maxLength+"'/>"}selectFormatter(e,o,s){if(e.item.__nonDataRow)return Nt(e.value);var a="edit",d=e.item,m=this.pendingChanges[d.ProductID],N=e.column;m&&m[o]!==void 0&&(a+=" dirty");var le=this.getEffectiveValue(d,o),J="<select class='"+a+"' data-field='"+o+"' style='width: 100%; max-width: 100%'><option value=''>--</option>";for(var b of s.items){let ye=b[s.idField];J+="<option value='"+Nt(ye)+"'",ye==le&&(J+=" selected"),J+=">"+Nt(b[s.textField])+"</option>"}return J+"</select>"}getEffectiveValue(e,o){var s=this.pendingChanges[e.ProductID];return s&&s[o]!==void 0?s[o]:e[o]}getColumns(){var e=super.getColumns(),o=t(m=>this.numericInputFormatter(m),"num"),s=t(m=>this.stringInputFormatter(m),"str");ze(e,m=>m.field==="QuantityPerUnit").format=s;var a=ze(e,m=>m.field===fe.CategoryName);a.referencedFields=[fe.CategoryID],a.format=m=>this.selectFormatter(m,fe.CategoryID,L.getLookup());var d=ze(e,m=>m.field===fe.SupplierCompanyName);return d.referencedFields=[fe.SupplierID],d.format=m=>this.selectFormatter(m,fe.SupplierID,O.getLookup()),ze(e,m=>m.field===fe.UnitPrice).format=o,ze(e,m=>m.field===fe.UnitsInStock).format=o,ze(e,m=>m.field===fe.UnitsOnOrder).format=o,ze(e,m=>m.field===fe.ReorderLevel).format=o,e}inputsChange(e){var o=this.slickGrid.getCellFromEvent(e),s=this.itemAt(o.row),a=$(e.target),d=a.data("field"),m=$s(a.val()),N=this.pendingChanges[s.ProductID],le=this.getEffectiveValue(s,d),J;a.hasClass("numeric")?J=nr(le,"0.##"):J=le;var b;if(d==="UnitPrice"){if(b=Xs(m!=null?m:""),b==null||isNaN(b)){Jo(Vo("Validation.Decimal"),"",null),a.val(J),a.focus();return}}else if(a.hasClass("numeric")){var ye=Js(m!=null?m:"");if(isNaN(ye)||ye>32767||ye<0){Jo(Vo("Validation.Integer"),"",null),a.val(J),a.focus();return}b=ye}else a.is("select")?b=Ws(a.val()):b=m;N||(this.pendingChanges[s.ProductID]=N={}),N[d]=b,s[d]=b,this.view.refresh(),a.hasClass("numeric")&&(b=nr(b,"0.##")),a.val(b).addClass("dirty"),this.setSaveButtonState()}setSaveButtonState(){this.toolbar.findButton("apply-changes-button").toggleClass("disabled",Object.keys(this.pendingChanges).length===0)}saveClick(){if(Object.keys(this.pendingChanges).length!==0){var e=Object.keys(this.pendingChanges),o=-1,s=this;t(function a(){if(++o>=e.length){s.refresh();return}var d=e[o],m=Ks(s.pendingChanges[d]);m.ProductID=d,zs(Re.Methods.Update,{EntityId:d,Entity:m},N=>{delete s.pendingChanges[d],a()})},"saveNext")()}}getQuickFilters(){var e=super.getQuickFilters(),o=Vs();if(o.cat){var s=js(e,a=>a.field=="CategoryID");s.init=a=>{a.element.getWidget(Bs).value=o.cat}}return e}};t(Ht,"ProductGrid"),Ht=y([Xo.registerClass(),Xo.filterable()],Ht);import{Decorators as el,EntityDialog as tl}from"@serenity-is/corelib";var We=class extends tl{constructor(){super(...arguments);this.form=new He(this.idPrefix)}getFormKey(){return He.formKey}getRowDefinition(){return M}getService(){return vt.baseUrl}};t(We,"RegionDialog"),We=y([el.registerClass("Serenity.Demo.Northwind.RegionDialog")],We);import{Decorators as rl,EntityGrid as ol}from"@serenity-is/corelib";var Gt=class extends ol{getColumnsKey(){return ht.columnsKey}getDialogType(){return We}getRowDefinition(){return M}getService(){return vt.baseUrl}};t(Gt,"RegionGrid"),Gt=y([rl.registerClass("Serenity.Demo.Northwind.RegionGrid")],Gt);import{Decorators as il,EntityDialog as nl}from"@serenity-is/corelib";var $e=class extends nl{constructor(){super(...arguments);this.form=new Ge(this.idPrefix)}getFormKey(){return Ge.formKey}getRowDefinition(){return H}getService(){return xt.baseUrl}};t($e,"ShipperDialog"),$e=y([il.registerClass()],$e);import{Decorators as al,EntityGrid as sl}from"@serenity-is/corelib";var Qt=class extends sl{getColumnsKey(){return gt.columnsKey}getDialogType(){return $e}getRowDefinition(){return H}getService(){return xt.baseUrl}};t(Qt,"ShipperGrid"),Qt=y([al.registerClass()],Qt);import{Decorators as ll,EntityGrid as pl}from"@serenity-is/corelib";var Bt=class extends pl{getColumnsKey(){return Dt.columnsKey}getDialogType(){return De}getRowDefinition(){return O}getService(){return yt.baseUrl}};t(Bt,"SupplierGrid"),Bt=y([ll.registerClass("Serenity.Demo.Northwind.SupplierGrid")],Bt);import{Decorators as dl,EntityDialog as ul}from"@serenity-is/corelib";var je=class extends ul{constructor(){super(...arguments);this.form=new Qe(this.idPrefix)}getFormKey(){return Qe.formKey}getRowDefinition(){return G}getService(){return Rt.baseUrl}};t(je,"TerritoryDialog"),je=y([dl.registerClass("Serenity.Demo.Northwind.TerritoryDialog")],je);import{Decorators as cl,EntityGrid as ml}from"@serenity-is/corelib";var Kt=class extends ml{getColumnsKey(){return St.columnsKey}getDialogType(){return je}getRowDefinition(){return G}getService(){return Rt.baseUrl}};t(Kt,"TerritoryGrid"),Kt=y([cl.registerClass("Serenity.Demo.Northwind.TerritoryGrid")],Kt);export{nt as CategoryColumns,Se as CategoryDialog,Pe as CategoryForm,Ft as CategoryGrid,te as CategoryLangRow,Co as CategoryLangService,L as CategoryRow,at as CategoryService,lt as CustomerColumns,re as CustomerCustomerDemoRow,oe as CustomerDemographicRow,ie as CustomerDetailsRow,Je as CustomerDialog,Oe as CustomerEditor,Ie as CustomerForm,Mt as CustomerGrid,de as CustomerGrossSalesRow,Ke as CustomerOrderDialog,Xe as CustomerOrdersGrid,ue as CustomerRepresentativesRow,F as CustomerRow,pt as CustomerService,Le as EmployeeFormatter,st as EmployeeListFormatter,K as EmployeeRow,ne as EmployeeTerritoryRow,ut as FreightFormatter,Ur as Gender,xe as NoteDialog,ae as NoteRow,we as NotesEditor,ct as OrderColumns,mt as OrderDetailColumns,_e as OrderDetailDialog,Ae as OrderDetailForm,X as OrderDetailRow,_o as OrderDetailService,ke as OrderDetailsEditor,ge as OrderDialog,qe as OrderForm,Be as OrderGrid,A as OrderRow,Ue as OrderService,Fr as OrderShippingState,ko as PermissionKeys,q as PhoneEditor,ft as ProductColumns,Ve as ProductDialog,Me as ProductForm,Ht as ProductGrid,se as ProductLangRow,qo as ProductLangService,ce as ProductLogRow,S as ProductRow,Re as ProductService,ht as RegionColumns,We as RegionDialog,He as RegionForm,Gt as RegionGrid,M as RegionRow,vt as RegionService,or as SalesByCategoryColumns,me as SalesByCategoryRow,Uo as SalesByCategoryService,gt as ShipperColumns,$e as ShipperDialog,Ge as ShipperForm,dt as ShipperFormatter,Qt as ShipperGrid,H as ShipperRow,xt as ShipperService,Dt as SupplierColumns,De as SupplierDialog,Fe as SupplierForm,Bt as SupplierGrid,O as SupplierRow,yt as SupplierService,St as TerritoryColumns,je as TerritoryDialog,Qe as TerritoryForm,Kt as TerritoryGrid,G as TerritoryRow,Rt as TerritoryService};
/*! Bundled license information:

dompurify/dist/purify.js:
  (*! @license DOMPurify 3.0.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.0.1/LICENSE *)
*/
//# sourceMappingURL=index.js.map
